---
title: "Conserved_human_specific_tDMRs"
author: "Lauren Blake"
date: "April 3, 2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Introduction

```{r, include = FALSE}
# Import libraries

library("ggplot2")
library("VennDiagram")
library("RColorBrewer")
library(plyr)
library("bedr")
library("cowplot")
getwd()

# Load colors 

colors <- colorRampPalette(c(brewer.pal(9, "Blues")[1],brewer.pal(9, "Blues")[9]))(100)
pal <- c(brewer.pal(9, "Set1"), brewer.pal(8, "Set2"), brewer.pal(12, "Set3"))

# Import the data

# Human tDMRs
humans_heart_kidney_DMRs <- read.delim("../data/humans_heart_kidney_DMRs.txt")
humans_heart_liver_DMRs <- read.delim("../data/humans_heart_liver_DMRs.txt")
humans_heart_lung_DMRs <- read.delim("../data/humans_heart_lung_DMRs.txt")
humans_liver_lung_DMRs <- read.delim("../data/humans_liver_lung_DMRs.txt")
humans_liver_kidney_DMRs <- read.delim("../data/humans_liver_kidney_DMRs.txt")
humans_lung_kidney_DMRs <- read.delim("../data/humans_lung_kidney_DMRs.txt")

levels(humans_lung_kidney_DMRs[,1])
count(humans_lung_kidney_DMRs[,1])

# Chimp tDMRs
chimps_heart_kidney_DMRs <- read.delim("../data/chimps_heart_kidney_DMRs.txt")
chimps_heart_liver_DMRs <- read.delim("../data/chimps_heart_liver_DMRs.txt")
chimps_heart_lung_DMRs <- read.delim("../data/chimps_heart_lung_DMRs.txt")
chimps_liver_lung_DMRs <- read.delim("../data/chimps_liver_lung_DMRs.txt")
chimps_liver_kidney_DMRs <- read.delim("../data/chimps_liver_kidney_DMRs.txt")
chimps_lung_kidney_DMRs <- read.delim("../data/chimps_lung_kidney_DMRs.txt")

levels(chimps_lung_kidney_DMRs[,1])
count(chimps_lung_kidney_DMRs[,1])

# Rhesus tDMRs

rhesus_heart_kidney_DMRs <- read.delim("../data/rhesus_heart_kidney_DMRs.txt")
rhesus_heart_liver_DMRs <- read.delim("../data/rhesus_heart_liver_DMRs.txt")
rhesus_heart_lung_DMRs <- read.delim("../data/rhesus_heart_lung_DMRs.txt")
rhesus_liver_lung_DMRs <- read.delim("../data/rhesus_liver_lung_DMRs.txt")
rhesus_liver_kidney_DMRs <- read.delim("../data/rhesus_liver_kidney_DMRs.txt")
rhesus_lung_kidney_DMRs <- read.delim("../data/rhesus_lung_kidney_DMRs.txt")

levels(rhesus_heart_kidney_DMRs[,1])
count(rhesus_lung_kidney_DMRs[,1])
```


# Get human, chimp, and rhesus autosomal tDMRs 


```{r, include = FALSE}
# Human heart-liver

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_heart_liver_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_humans_heart_liver_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# Human heart-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_heart_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_humans_heart_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# human heart-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_heart_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_humans_heart_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX, check.chr = FALSE)


# human liver-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_liver_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_humans_liver_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)


# human liver-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_liver_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_humans_liver_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# human lung-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_lung_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])
summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_humans_lung_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

```


```{r}
# Chimp heart-liver

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_heart_liver_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_chimps_heart_liver_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# Chimp heart-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_heart_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_chimps_heart_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# chimp heart-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_heart_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_chimps_heart_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX, check.chr = FALSE)


# Chimp liver-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_liver_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_chimps_liver_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)


# chimp liver-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_liver_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_chimps_liver_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# chimp lung-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_lung_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])
summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_chimps_lung_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)
```

```{r, include = FALSE}
# Rhesus heart-liver

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_heart_liver_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_rhesus_heart_liver_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# Chimp heart-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_heart_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_rhesus_heart_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# chimp heart-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_heart_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_rhesus_heart_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX, check.chr = FALSE)


# Chimp liver-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_liver_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_rhesus_liver_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)


# chimp liver-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_liver_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_rhesus_liver_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# chimp lung-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_lung_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])
summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_rhesus_lung_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)
```

# Number of autosomal tDMRs

```{r}
# Humans
nrow(sort_humans_heart_liver_DMRs_bed)
nrow(sort_humans_heart_lung_DMRs_bed)
nrow(sort_humans_heart_kidney_DMRs_bed)
nrow(sort_humans_liver_lung_DMRs_bed)
nrow(sort_humans_liver_kidney_DMRs_bed)
nrow(sort_humans_lung_kidney_DMRs_bed)

summary(sort_humans_heart_liver_DMRs_bed$direction == "hyper")
summary(sort_humans_heart_lung_DMRs_bed$direction == "hyper")
summary(sort_humans_heart_kidney_DMRs_bed$direction == "hyper")
summary(sort_humans_liver_lung_DMRs_bed$direction == "hyper")
summary(sort_humans_liver_kidney_DMRs_bed$direction == "hyper")
summary(sort_humans_lung_kidney_DMRs_bed$direction == "hyper")


# Chimps
nrow(sort_chimps_heart_liver_DMRs_bed)
nrow(sort_chimps_heart_lung_DMRs_bed)
nrow(sort_chimps_heart_kidney_DMRs_bed)
nrow(sort_chimps_liver_lung_DMRs_bed)
nrow(sort_chimps_liver_kidney_DMRs_bed)
nrow(sort_chimps_lung_kidney_DMRs_bed)


summary(sort_chimps_heart_liver_DMRs_bed$direction == "hyper")
summary(sort_chimps_heart_lung_DMRs_bed$direction == "hyper")
summary(sort_chimps_heart_kidney_DMRs_bed$direction == "hyper")
summary(sort_chimps_liver_lung_DMRs_bed$direction == "hyper")
summary(sort_chimps_liver_kidney_DMRs_bed$direction == "hyper")
summary(sort_chimps_lung_kidney_DMRs_bed$direction == "hyper")

# Rhesus
nrow(sort_rhesus_heart_liver_DMRs_bed)
nrow(sort_rhesus_heart_lung_DMRs_bed)
nrow(sort_rhesus_heart_kidney_DMRs_bed)
nrow(sort_rhesus_liver_lung_DMRs_bed)
nrow(sort_rhesus_liver_kidney_DMRs_bed)
nrow(sort_rhesus_lung_kidney_DMRs_bed)

summary(sort_rhesus_heart_liver_DMRs_bed$direction == "hyper")
summary(sort_rhesus_heart_lung_DMRs_bed$direction == "hyper")
summary(sort_rhesus_heart_kidney_DMRs_bed$direction == "hyper")
summary(sort_rhesus_liver_lung_DMRs_bed$direction == "hyper")
summary(sort_rhesus_liver_kidney_DMRs_bed$direction == "hyper")
summary(sort_rhesus_lung_kidney_DMRs_bed$direction == "hyper")

```




# Identify human-specific versus conserved DMRs

The goal of this is to look for human specific versus conserved in 1 pair of tissues when you define conservation as overlap at a variety of bp overlaps. 

```{r, include = FALSE}
# 1 bp fit 
tissue_conserved_1_overlap <- function(DMR1_human, DMR1_chimp, DMR1_rhesus){

# Human-chimp/human-rhesus

human_chimp_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_chimp), method = "intersect",  params = "-wao", check.chr = FALSE)

human_chimp_DMR <- human_chimp_DMR[which(human_chimp_DMR[,6] != -1), ]

human_rhesus_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_rhesus), method = "intersect",  params = "-wao", check.chr = FALSE)

human_rhesus_DMR <- human_rhesus_DMR[which(human_rhesus_DMR[,6] != -1), ]

chimp_rhesus_DMR <- bedr(input = list(a = DMR1_chimp, b = DMR1_rhesus), method = "intersect",  params = "-wao", check.chr = FALSE)

chimp_rhesus_DMR <- chimp_rhesus_DMR[which(chimp_rhesus_DMR[,6] != -1), ]

colnames(human_chimp_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(chimp_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_chimp_DMR <- bedr.merge.region(human_chimp_DMR)
human_rhesus_DMR <- bedr.merge.region(human_rhesus_DMR)
chimp_rhesus_DMR <- bedr.merge.region(chimp_rhesus_DMR)

# Human-chimp-rhesus

human_chimp_rhesus1_DMR <- bedr(input = list(a = human_chimp_DMR, b = human_rhesus_DMR), method = "intersect",  params = "-wao", check.chr = FALSE)

human_chimp_rhesus1a_DMR <- human_chimp_rhesus1_DMR[which(human_chimp_rhesus1_DMR[,6] != -1), ]

human_chimp_rhesus2_DMR <- bedr(input = list(a = human_chimp_rhesus1a_DMR[,1:4], b = chimp_rhesus_DMR), method = "intersect",  params = "-wao", check.chr = FALSE)

human_chimp_rhesus2a_DMR <- human_chimp_rhesus2_DMR[which(human_chimp_rhesus2_DMR[,6] != -1), ]

nrow(human_chimp_rhesus2a_DMR)

# human_chimp_rhesus2a_DMR gives the number of H/C/R conserved tDMRs

# Conserved in only 2 species

human_chimp_only <- bedr(input = list(a = human_chimp_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao", check.chr = FALSE)

human_chimp_only <- human_chimp_only[which(human_chimp_only[,6] == -1), ]

nrow(human_chimp_only)

human_rhesus_only <- bedr(input = list(a = human_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao", check.chr = FALSE)

human_rhesus_only <- human_rhesus_only[which(human_rhesus_only[,6] == -1), ]

nrow(human_rhesus_only)

chimp_rhesus_only <- bedr(input = list(a = chimp_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao", check.chr = FALSE)

chimp_rhesus_only <- chimp_rhesus_only[which(chimp_rhesus_only[,6] == -1), ]

nrow(chimp_rhesus_only)

# Species-specific

human_specific <- nrow(DMR1_human) - nrow(human_chimp_only) - nrow(human_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

chimp_specific <- nrow(DMR1_chimp) - nrow(human_chimp_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

rhesus_specific <- nrow(DMR1_rhesus) - nrow(human_rhesus_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

combine <- cbind(human_specific, chimp_specific, rhesus_specific, nrow(human_chimp_only), nrow(human_rhesus_only), nrow(chimp_rhesus_only), nrow(human_chimp_rhesus2a_DMR))

colnames(combine) <- c("human_specific", "chimp_specific", "rhesus_specific", "hc", "hr", "cr", "hcr_conserved")

return(combine)
}

# 25% overlap

tissue_conserved_25_overlap <- function(DMR1_human, DMR1_chimp, DMR1_rhesus){

# Human-chimp/human-rhesus

human_chimp_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_chimp), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_DMR <- human_chimp_DMR[which(human_chimp_DMR[,6] != -1), ]

human_rhesus_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_rhesus), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_rhesus_DMR <- human_rhesus_DMR[which(human_rhesus_DMR[,6] != -1), ]

chimp_rhesus_DMR <- bedr(input = list(a = DMR1_chimp, b = DMR1_rhesus), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

chimp_rhesus_DMR <- chimp_rhesus_DMR[which(chimp_rhesus_DMR[,6] != -1), ]

colnames(human_chimp_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(chimp_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_chimp_DMR <- bedr.merge.region(human_chimp_DMR)
human_rhesus_DMR <- bedr.merge.region(human_rhesus_DMR)
chimp_rhesus_DMR <- bedr.merge.region(chimp_rhesus_DMR)

# Human-chimp-rhesus

human_chimp_rhesus1_DMR <- bedr(input = list(a = human_chimp_DMR, b = human_rhesus_DMR), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_rhesus1a_DMR <- human_chimp_rhesus1_DMR[which(human_chimp_rhesus1_DMR[,6] != -1), ]

human_chimp_rhesus2_DMR <- bedr(input = list(a = human_chimp_rhesus1a_DMR[,1:4], b = chimp_rhesus_DMR), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_rhesus2a_DMR <- human_chimp_rhesus2_DMR[which(human_chimp_rhesus2_DMR[,6] != -1), ]

nrow(human_chimp_rhesus2a_DMR)

# human_chimp_rhesus2a_DMR gives the number of H/C/R conserved tDMRs

# Conserved in only 2 species

human_chimp_only <- bedr(input = list(a = human_chimp_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_only <- human_chimp_only[which(human_chimp_only[,6] == -1), ]

nrow(human_chimp_only)

human_rhesus_only <- bedr(input = list(a = human_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_rhesus_only <- human_rhesus_only[which(human_rhesus_only[,6] == -1), ]

nrow(human_rhesus_only)

chimp_rhesus_only <- bedr(input = list(a = chimp_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

chimp_rhesus_only <- chimp_rhesus_only[which(chimp_rhesus_only[,6] == -1), ]

nrow(chimp_rhesus_only)

# Species-specific

human_specific <- nrow(DMR1_human) - nrow(human_chimp_only) - nrow(human_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

chimp_specific <- nrow(DMR1_chimp) - nrow(human_chimp_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

rhesus_specific <- nrow(DMR1_rhesus) - nrow(human_rhesus_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

combine <- cbind(human_specific, chimp_specific, rhesus_specific, nrow(human_chimp_only), nrow(human_rhesus_only), nrow(chimp_rhesus_only), nrow(human_chimp_rhesus2a_DMR))

colnames(combine) <- c("human_specific", "chimp_specific", "rhesus_specific", "hc", "hr", "cr", "hcr_conserved")

return(combine)
}


# 50% overlap

tissue_conserved_50_overlap <- function(DMR1_human, DMR1_chimp, DMR1_rhesus){

# Human-chimp/human-rhesus

human_chimp_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_chimp), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_chimp_DMR <- human_chimp_DMR[which(human_chimp_DMR[,6] != -1), ]

human_rhesus_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_rhesus), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_rhesus_DMR <- human_rhesus_DMR[which(human_rhesus_DMR[,6] != -1), ]

chimp_rhesus_DMR <- bedr(input = list(a = DMR1_chimp, b = DMR1_rhesus), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

chimp_rhesus_DMR <- chimp_rhesus_DMR[which(chimp_rhesus_DMR[,6] != -1), ]

colnames(human_chimp_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(chimp_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_chimp_DMR <- bedr.merge.region(human_chimp_DMR)
human_rhesus_DMR <- bedr.merge.region(human_rhesus_DMR)
chimp_rhesus_DMR <- bedr.merge.region(chimp_rhesus_DMR)

# Human-chimp-rhesus

human_chimp_rhesus1_DMR <- bedr(input = list(a = human_chimp_DMR, b = human_rhesus_DMR), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_chimp_rhesus1a_DMR <- human_chimp_rhesus1_DMR[which(human_chimp_rhesus1_DMR[,6] != -1), ]

human_chimp_rhesus2_DMR <- bedr(input = list(a = human_chimp_rhesus1a_DMR[,1:4], b = chimp_rhesus_DMR), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_chimp_rhesus2a_DMR <- human_chimp_rhesus2_DMR[which(human_chimp_rhesus2_DMR[,6] != -1), ]

nrow(human_chimp_rhesus2a_DMR)

# human_chimp_rhesus2a_DMR gives the number of H/C/R conserved tDMRs

# Conserved in only 2 species

human_chimp_only <- bedr(input = list(a = human_chimp_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_chimp_only <- human_chimp_only[which(human_chimp_only[,6] == -1), ]

nrow(human_chimp_only)

human_rhesus_only <- bedr(input = list(a = human_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_rhesus_only <- human_rhesus_only[which(human_rhesus_only[,6] == -1), ]

nrow(human_rhesus_only)

chimp_rhesus_only <- bedr(input = list(a = chimp_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

chimp_rhesus_only <- chimp_rhesus_only[which(chimp_rhesus_only[,6] == -1), ]

nrow(chimp_rhesus_only)

# Species-specific

human_specific <- nrow(DMR1_human) - nrow(human_chimp_only) - nrow(human_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

chimp_specific <- nrow(DMR1_chimp) - nrow(human_chimp_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

rhesus_specific <- nrow(DMR1_rhesus) - nrow(human_rhesus_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

combine <- cbind(human_specific, chimp_specific, rhesus_specific, nrow(human_chimp_only), nrow(human_rhesus_only), nrow(chimp_rhesus_only), nrow(human_chimp_rhesus2a_DMR))

colnames(combine) <- c("human_specific", "chimp_specific", "rhesus_specific", "hc", "hr", "cr", "hcr_conserved")

return(combine)
}

# 75% overlap

tissue_conserved_75_overlap <- function(DMR1_human, DMR1_chimp, DMR1_rhesus){

# Human-chimp/human-rhesus

human_chimp_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_chimp), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_chimp_DMR <- human_chimp_DMR[which(human_chimp_DMR[,6] != -1), ]

human_rhesus_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_rhesus), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_rhesus_DMR <- human_rhesus_DMR[which(human_rhesus_DMR[,6] != -1), ]

chimp_rhesus_DMR <- bedr(input = list(a = DMR1_chimp, b = DMR1_rhesus), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

chimp_rhesus_DMR <- chimp_rhesus_DMR[which(chimp_rhesus_DMR[,6] != -1), ]

colnames(human_chimp_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(chimp_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_chimp_DMR <- bedr.merge.region(human_chimp_DMR)
human_rhesus_DMR <- bedr.merge.region(human_rhesus_DMR)
chimp_rhesus_DMR <- bedr.merge.region(chimp_rhesus_DMR)

# Human-chimp-rhesus

human_chimp_rhesus1_DMR <- bedr(input = list(a = human_chimp_DMR, b = human_rhesus_DMR), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_chimp_rhesus1a_DMR <- human_chimp_rhesus1_DMR[which(human_chimp_rhesus1_DMR[,6] != -1), ]

human_chimp_rhesus2_DMR <- bedr(input = list(a = human_chimp_rhesus1a_DMR[,1:4], b = chimp_rhesus_DMR), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_chimp_rhesus2a_DMR <- human_chimp_rhesus2_DMR[which(human_chimp_rhesus2_DMR[,6] != -1), ]

nrow(human_chimp_rhesus2a_DMR)

# human_chimp_rhesus2a_DMR gives the number of H/C/R conserved tDMRs

# Conserved in only 2 species

human_chimp_only <- bedr(input = list(a = human_chimp_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_chimp_only <- human_chimp_only[which(human_chimp_only[,6] == -1), ]

nrow(human_chimp_only)

human_rhesus_only <- bedr(input = list(a = human_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_rhesus_only <- human_rhesus_only[which(human_rhesus_only[,6] == -1), ]

nrow(human_rhesus_only)

chimp_rhesus_only <- bedr(input = list(a = chimp_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

chimp_rhesus_only <- chimp_rhesus_only[which(chimp_rhesus_only[,6] == -1), ]

nrow(chimp_rhesus_only)

# Species-specific

human_specific <- nrow(DMR1_human) - nrow(human_chimp_only) - nrow(human_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

chimp_specific <- nrow(DMR1_chimp) - nrow(human_chimp_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

rhesus_specific <- nrow(DMR1_rhesus) - nrow(human_rhesus_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

combine <- cbind(human_specific, chimp_specific, rhesus_specific, nrow(human_chimp_only), nrow(human_rhesus_only), nrow(chimp_rhesus_only), nrow(human_chimp_rhesus2a_DMR))

colnames(combine) <- c("human_specific", "chimp_specific", "rhesus_specific", "hc", "hr", "cr", "hcr_conserved")

return(combine)
}
```


## Run for all tissues

### 1% overlap- all


```{r}
# Heart-kidney

tissue_conserved_1_overlap(sort_humans_heart_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed)

#      human_specific chimp_specific rhesus_specific   hc   hr cr
#[1,]          18751           7585           15098 5269 3080 1654
#     hcr_conserved
#[1,]          3191

# Heart liver
tissue_conserved_1_overlap(sort_humans_heart_liver_DMRs_bed, sort_chimps_heart_liver_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           8652          12855           27802 5310 2876 4879
#     hcr_conserved
#[1,]          5723
     
     
# Heart lung
tissue_conserved_1_overlap(sort_humans_heart_lung_DMRs_bed, sort_chimps_heart_lung_DMRs_bed, sort_rhesus_heart_lung_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr
#[1,]          10440           4927            4960 2294 763 592
#     hcr_conserved
#[1,]           711

# Liver lung
tissue_conserved_1_overlap(sort_humans_liver_lung_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed)

 #    human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           4476          11393           23572 3333 1683 4031
#     hcr_conserved
#[1,]          3350


# Liver-Kidney
tissue_conserved_1_overlap(sort_humans_liver_kidney_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           7402          11956           26043 4360 2336 3719
#     hcr_conserved
#[1,]          3812

# Lung-kidney
tissue_conserved_1_overlap(sort_humans_lung_kidney_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]          10166           6361           11466 3027 1735 1095
#     hcr_conserved
#[1,]          1593
```

### 1% overlap in hypo methylated
```{r}
sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hypo"),]

# Heart-kidney

tissue_conserved_1_overlap(sort_humans_heart_kidney_DMRs_bed_hypo, sort_chimps_heart_kidney_DMRs_bed_hypo, sort_rhesus_heart_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]           8337           3851            6633 2167 1191 803
#     hcr_conserved
#[1,]          1157

# Heart liver

sort_humans_heart_liver_DMRs_bed_hypo <- sort_humans_heart_liver_DMRs_bed[which(sort_humans_heart_liver_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_liver_DMRs_bed_hypo <- sort_chimps_heart_liver_DMRs_bed[which(sort_chimps_heart_liver_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_liver_DMRs_bed_hypo <- sort_rhesus_heart_liver_DMRs_bed[which(sort_rhesus_heart_liver_DMRs_bed[,4] == "hypo"),]

tissue_conserved_1_overlap(sort_humans_heart_liver_DMRs_bed_hypo, sort_chimps_heart_liver_DMRs_bed_hypo, sort_rhesus_heart_liver_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           5291           6148           12367 2427 1440 2452
#     hcr_conserved
#[1,]          2537
     
     
# Heat lung

sort_humans_heart_lung_DMRs_bed_hypo <- sort_humans_heart_lung_DMRs_bed[which(sort_humans_heart_lung_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_lung_DMRs_bed_hypo <- sort_chimps_heart_lung_DMRs_bed[which(sort_chimps_heart_lung_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_lung_DMRs_bed_hypo <- sort_rhesus_heart_lung_DMRs_bed[which(sort_rhesus_heart_lung_DMRs_bed[,4] == "hypo"),]

tissue_conserved_1_overlap(sort_humans_heart_lung_DMRs_bed_hypo, sort_chimps_heart_lung_DMRs_bed_hypo, sort_rhesus_heart_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr
#[1,]           6922           2936            2734 1589 472 357
#     hcr_conserved
#[1,]           505

# Liver lung
sort_humans_liver_lung_DMRs_bed_hypo <- sort_humans_liver_lung_DMRs_bed[which(sort_humans_liver_lung_DMRs_bed[,4] == "hypo"),]

sort_chimps_liver_lung_DMRs_bed_hypo <- sort_chimps_liver_lung_DMRs_bed[which(sort_chimps_liver_lung_DMRs_bed[,4] == "hypo"),]

sort_rhesus_liver_lung_DMRs_bed_hypo <- sort_rhesus_liver_lung_DMRs_bed[which(sort_rhesus_liver_lung_DMRs_bed[,4] == "hypo"),]

tissue_conserved_1_overlap(sort_humans_liver_lung_DMRs_bed_hypo, sort_chimps_liver_lung_DMRs_bed_hypo, sort_rhesus_liver_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr
#[1,]           2380           7168           13737 2364 953 2392
#     hcr_conserved
#[1,]          2393


# Liver-Kidney
sort_humans_liver_kidney_DMRs_bed_hypo <- sort_humans_liver_kidney_DMRs_bed[which(sort_humans_liver_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_liver_kidney_DMRs_bed_hypo <- sort_chimps_liver_kidney_DMRs_bed[which(sort_chimps_liver_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_liver_kidney_DMRs_bed_hypo <- sort_rhesus_liver_kidney_DMRs_bed[which(sort_rhesus_liver_kidney_DMRs_bed[,4] == "hypo"),]

tissue_conserved_1_overlap(sort_humans_liver_kidney_DMRs_bed_hypo, sort_chimps_liver_kidney_DMRs_bed_hypo, sort_rhesus_liver_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr
#[1,]           2213           6412           14142 1761 816 1957
#     hcr_conserved
#[1,]          1578

# Lung-kidney

sort_humans_lung_kidney_DMRs_bed_hypo <- sort_humans_lung_kidney_DMRs_bed[which(sort_humans_lung_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_lung_kidney_DMRs_bed_hypo <- sort_chimps_lung_kidney_DMRs_bed[which(sort_chimps_lung_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_lung_kidney_DMRs_bed_hypo <- sort_rhesus_lung_kidney_DMRs_bed[which(sort_rhesus_lung_kidney_DMRs_bed[,4] == "hypo"),]

tissue_conserved_1_overlap(sort_humans_lung_kidney_DMRs_bed_hypo, sort_chimps_lung_kidney_DMRs_bed_hypo, sort_rhesus_lung_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr
#[1,]           2940           2478            4440 696 445 386
#     hcr_conserved
#[1,]           340
```


### 1% overlap in hyper methylated
```{r}
sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hyper"),]

# Heart-kidney

tissue_conserved_1_overlap(sort_humans_heart_kidney_DMRs_bed_hypo, sort_chimps_heart_kidney_DMRs_bed_hypo, sort_rhesus_heart_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]          10493           3777            8595 3114 1814 812
#     hcr_conserved
#[1,]          2018

# Heart liver

sort_humans_heart_liver_DMRs_bed_hypo <- sort_humans_heart_liver_DMRs_bed[which(sort_humans_heart_liver_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_liver_DMRs_bed_hypo <- sort_chimps_heart_liver_DMRs_bed[which(sort_chimps_heart_liver_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_liver_DMRs_bed_hypo <- sort_rhesus_heart_liver_DMRs_bed[which(sort_rhesus_heart_liver_DMRs_bed[,4] == "hyper"),]

tissue_conserved_1_overlap(sort_humans_heart_liver_DMRs_bed_hypo, sort_chimps_heart_liver_DMRs_bed_hypo, sort_rhesus_heart_liver_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           3510           6851           15744 2924 1312 2308
#     hcr_conserved
#[1,]          3120
     
     
# Heat lung

sort_humans_heart_lung_DMRs_bed_hypo <- sort_humans_heart_lung_DMRs_bed[which(sort_humans_heart_lung_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_lung_DMRs_bed_hypo <- sort_chimps_heart_lung_DMRs_bed[which(sort_chimps_heart_lung_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_lung_DMRs_bed_hypo <- sort_rhesus_heart_lung_DMRs_bed[which(sort_rhesus_heart_lung_DMRs_bed[,4] == "hyper"),]

tissue_conserved_1_overlap(sort_humans_heart_lung_DMRs_bed_hypo, sort_chimps_heart_lung_DMRs_bed_hypo, sort_rhesus_heart_lung_DMRs_bed_hypo)

 #    human_specific chimp_specific rhesus_specific  hc  hr  cr
#[1,]           3546           2005            2262 704 268 226
#     hcr_conserved
#[1,]           202

# Liver lung
sort_humans_liver_lung_DMRs_bed_hypo <- sort_humans_liver_lung_DMRs_bed[which(sort_humans_liver_lung_DMRs_bed[,4] == "hyper"),]

sort_chimps_liver_lung_DMRs_bed_hypo <- sort_chimps_liver_lung_DMRs_bed[which(sort_chimps_liver_lung_DMRs_bed[,4] == "hyper"),]

sort_rhesus_liver_lung_DMRs_bed_hypo <- sort_rhesus_liver_lung_DMRs_bed[which(sort_rhesus_liver_lung_DMRs_bed[,4] == "hyper"),]

tissue_conserved_1_overlap(sort_humans_liver_lung_DMRs_bed_hypo, sort_chimps_liver_lung_DMRs_bed_hypo, sort_rhesus_liver_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr   cr
#[1,]           2182           4349           10052 988 656 1527
#     hcr_conserved
#[1,]           926


# Liver-Kidney
sort_humans_liver_kidney_DMRs_bed_hypo <- sort_humans_liver_kidney_DMRs_bed[which(sort_humans_liver_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_liver_kidney_DMRs_bed_hypo <- sort_chimps_liver_kidney_DMRs_bed[which(sort_chimps_liver_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_liver_kidney_DMRs_bed_hypo <- sort_rhesus_liver_kidney_DMRs_bed[which(sort_rhesus_liver_kidney_DMRs_bed[,4] == "hyper"),]

tissue_conserved_1_overlap(sort_humans_liver_kidney_DMRs_bed_hypo, sort_chimps_liver_kidney_DMRs_bed_hypo, sort_rhesus_liver_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           5288           5680           12146 2619 1431 1636
#     hcr_conserved
#[1,]          2204

# Lung-kidney

sort_humans_lung_kidney_DMRs_bed_hypo <- sort_humans_lung_kidney_DMRs_bed[which(sort_humans_lung_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_lung_kidney_DMRs_bed_hypo <- sort_chimps_lung_kidney_DMRs_bed[which(sort_chimps_lung_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_lung_kidney_DMRs_bed_hypo <- sort_rhesus_lung_kidney_DMRs_bed[which(sort_rhesus_lung_kidney_DMRs_bed[,4] == "hyper"),]

tissue_conserved_1_overlap(sort_humans_lung_kidney_DMRs_bed_hypo, sort_chimps_lung_kidney_DMRs_bed_hypo, sort_rhesus_lung_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]           7256           3911            7085 2336 1264 685
#     hcr_conserved
#[1,]          1244
```



### 25% overlap
```{r}
# Heart-kidney

tissue_conserved_25_overlap(sort_humans_heart_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed)

#      human_specific chimp_specific rhesus_specific   hc   hr cr
#[1,]          20415           9070           16631 4909 2672 1425
#     hcr_conserved
#[1,]          2295

# Heart liver
tissue_conserved_25_overlap(sort_humans_heart_liver_DMRs_bed, sort_chimps_heart_liver_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]          10676          15186           30727 5517 2489 4185
#     hcr_conserved
#[1,]          3879
     
     
# Heat lung
tissue_conserved_25_overlap(sort_humans_heart_lung_DMRs_bed, sort_chimps_heart_lung_DMRs_bed, sort_rhesus_heart_lung_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr
#[1,]          11053           5474            5399 2062 639 534
#     hcr_conserved
#[1,]           454

# Liver lung
tissue_conserved_25_overlap(sort_humans_liver_lung_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           5752          13218           25690 3424 1481 3280
#     hcr_conserved
#[1,]          2185

# Liver-Kidney
tissue_conserved_25_overlap(sort_humans_liver_kidney_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           5752          13218           25690 3424 1481 3280
#     hcr_conserved
#[1,]          2185

# Lung-kidney
tissue_conserved_25_overlap(sort_humans_lung_kidney_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]          11201           7216           12424 2795 1400 940
#     hcr_conserved
#[1,]          1125
```



### 25% overlap in hypo methylated
```{r}
sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hypo"),]

# Heart-kidney

tissue_conserved_25_overlap(sort_humans_heart_kidney_DMRs_bed_hypo, sort_chimps_heart_kidney_DMRs_bed_hypo, sort_rhesus_heart_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]           9025           4520            7252 1964 1038 669
#     hcr_conserved
#[1,]           825

# Heart liver

sort_humans_heart_liver_DMRs_bed_hypo <- sort_humans_heart_liver_DMRs_bed[which(sort_humans_heart_liver_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_liver_DMRs_bed_hypo <- sort_chimps_heart_liver_DMRs_bed[which(sort_chimps_heart_liver_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_liver_DMRs_bed_hypo <- sort_rhesus_heart_liver_DMRs_bed[which(sort_rhesus_heart_liver_DMRs_bed[,4] == "hypo"),]

tissue_conserved_25_overlap(sort_humans_heart_liver_DMRs_bed_hypo, sort_chimps_heart_liver_DMRs_bed_hypo, sort_rhesus_heart_liver_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           6214           7204           13610 2421 1247 2126
#     hcr_conserved
#[1,]          1813
     
     
# Heat lung

sort_humans_heart_lung_DMRs_bed_hypo <- sort_humans_heart_lung_DMRs_bed[which(sort_humans_heart_lung_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_lung_DMRs_bed_hypo <- sort_chimps_heart_lung_DMRs_bed[which(sort_chimps_heart_lung_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_lung_DMRs_bed_hypo <- sort_rhesus_heart_lung_DMRs_bed[which(sort_rhesus_heart_lung_DMRs_bed[,4] == "hypo"),]

tissue_conserved_25_overlap(sort_humans_heart_lung_DMRs_bed_hypo, sort_chimps_heart_lung_DMRs_bed_hypo, sort_rhesus_heart_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr
#[1,]           7319           3287            3013 1446 401 332
#     hcr_conserved
#[1,]           322

# Liver lung
sort_humans_liver_lung_DMRs_bed_hypo <- sort_humans_liver_lung_DMRs_bed[which(sort_humans_liver_lung_DMRs_bed[,4] == "hypo"),]

sort_chimps_liver_lung_DMRs_bed_hypo <- sort_chimps_liver_lung_DMRs_bed[which(sort_chimps_liver_lung_DMRs_bed[,4] == "hypo"),]

sort_rhesus_liver_lung_DMRs_bed_hypo <- sort_rhesus_liver_lung_DMRs_bed[which(sort_rhesus_liver_lung_DMRs_bed[,4] == "hypo"),]

tissue_conserved_25_overlap(sort_humans_liver_lung_DMRs_bed_hypo, sort_chimps_liver_lung_DMRs_bed_hypo, sort_rhesus_liver_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr
#[1,]           3188           8367           15115 2460 870 1918
#     hcr_conserved
#[1,]          1572


# Liver-Kidney
sort_humans_liver_kidney_DMRs_bed_hypo <- sort_humans_liver_kidney_DMRs_bed[which(sort_humans_liver_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_liver_kidney_DMRs_bed_hypo <- sort_chimps_liver_kidney_DMRs_bed[which(sort_chimps_liver_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_liver_kidney_DMRs_bed_hypo <- sort_rhesus_liver_kidney_DMRs_bed[which(sort_rhesus_liver_kidney_DMRs_bed[,4] == "hypo"),]

tissue_conserved_25_overlap(sort_humans_liver_kidney_DMRs_bed_hypo, sort_chimps_liver_kidney_DMRs_bed_hypo, sort_rhesus_liver_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr
#[1,]           2841           7349           15184 1772 722 1554
#     hcr_conserved
#[1,]          1033

# Lung-kidney

sort_humans_lung_kidney_DMRs_bed_hypo <- sort_humans_lung_kidney_DMRs_bed[which(sort_humans_lung_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_lung_kidney_DMRs_bed_hypo <- sort_chimps_lung_kidney_DMRs_bed[which(sort_chimps_lung_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_lung_kidney_DMRs_bed_hypo <- sort_rhesus_lung_kidney_DMRs_bed[which(sort_rhesus_lung_kidney_DMRs_bed[,4] == "hypo"),]

tissue_conserved_25_overlap(sort_humans_lung_kidney_DMRs_bed_hypo, sort_chimps_lung_kidney_DMRs_bed_hypo, sort_rhesus_lung_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr
#[1,]           3232           2738            4717 612 344 317
#     hcr_conserved
#[1,]           233
```


### 25% overlap in hyper methylated
```{r}
sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hyper"),]

# Heart-kidney

tissue_conserved_25_overlap(sort_humans_heart_kidney_DMRs_bed_hypo, sort_chimps_heart_kidney_DMRs_bed_hypo, sort_rhesus_heart_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]          11434           4582            9456 2949 1593 727
#     hcr_conserved
#[1,]          1463

# Heart liver

sort_humans_heart_liver_DMRs_bed_hypo <- sort_humans_heart_liver_DMRs_bed[which(sort_humans_heart_liver_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_liver_DMRs_bed_hypo <- sort_chimps_heart_liver_DMRs_bed[which(sort_chimps_heart_liver_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_liver_DMRs_bed_hypo <- sort_rhesus_heart_liver_DMRs_bed[which(sort_rhesus_heart_liver_DMRs_bed[,4] == "hyper"),]

tissue_conserved_25_overlap(sort_humans_heart_liver_DMRs_bed_hypo, sort_chimps_heart_liver_DMRs_bed_hypo, sort_rhesus_heart_liver_DMRs_bed_hypo)

#    human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           4545           8063           17283 3112 1173 1992
#     hcr_conserved
#[1,]          2036
     
     
# Heat lung

sort_humans_heart_lung_DMRs_bed_hypo <- sort_humans_heart_lung_DMRs_bed[which(sort_humans_heart_lung_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_lung_DMRs_bed_hypo <- sort_chimps_heart_lung_DMRs_bed[which(sort_chimps_heart_lung_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_lung_DMRs_bed_hypo <- sort_rhesus_heart_lung_DMRs_bed[which(sort_rhesus_heart_lung_DMRs_bed[,4] == "hyper"),]

tissue_conserved_25_overlap(sort_humans_heart_lung_DMRs_bed_hypo, sort_chimps_heart_lung_DMRs_bed_hypo, sort_rhesus_heart_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr
#[1,]           3752           2196            2409 615 223 196
#     hcr_conserved
#[1,]           130

# Liver lung
sort_humans_liver_lung_DMRs_bed_hypo <- sort_humans_liver_lung_DMRs_bed[which(sort_humans_liver_lung_DMRs_bed[,4] == "hyper"),]

sort_chimps_liver_lung_DMRs_bed_hypo <- sort_chimps_liver_lung_DMRs_bed[which(sort_chimps_liver_lung_DMRs_bed[,4] == "hyper"),]

sort_rhesus_liver_lung_DMRs_bed_hypo <- sort_rhesus_liver_lung_DMRs_bed[which(sort_rhesus_liver_lung_DMRs_bed[,4] == "hyper"),]

tissue_conserved_25_overlap(sort_humans_liver_lung_DMRs_bed_hypo, sort_chimps_liver_lung_DMRs_bed_hypo, sort_rhesus_liver_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr   cr
#[1,]           2621           4927           10707 968 559 1291
#     hcr_conserved
#[1,]           604


# Liver-Kidney
sort_humans_liver_kidney_DMRs_bed_hypo <- sort_humans_liver_kidney_DMRs_bed[which(sort_humans_liver_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_liver_kidney_DMRs_bed_hypo <- sort_chimps_liver_kidney_DMRs_bed[which(sort_chimps_liver_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_liver_kidney_DMRs_bed_hypo <- sort_rhesus_liver_kidney_DMRs_bed[which(sort_rhesus_liver_kidney_DMRs_bed[,4] == "hyper"),]

tissue_conserved_25_overlap(sort_humans_liver_kidney_DMRs_bed_hypo, sort_chimps_liver_kidney_DMRs_bed_hypo, sort_rhesus_liver_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr
#[1,]           6073           6548           13114 2576 1288 1410
#     hcr_conserved
#[1,]          1605

# Lung-kidney

sort_humans_lung_kidney_DMRs_bed_hypo <- sort_humans_lung_kidney_DMRs_bed[which(sort_humans_lung_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_lung_kidney_DMRs_bed_hypo <- sort_chimps_lung_kidney_DMRs_bed[which(sort_chimps_lung_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_lung_kidney_DMRs_bed_hypo <- sort_rhesus_lung_kidney_DMRs_bed[which(sort_rhesus_lung_kidney_DMRs_bed[,4] == "hyper"),]

tissue_conserved_25_overlap(sort_humans_lung_kidney_DMRs_bed_hypo, sort_chimps_lung_kidney_DMRs_bed_hypo, sort_rhesus_lung_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]           7985           4495            7739 2184 1042 608
#     hcr_conserved
#[1,]           889
```


### 50% overlap
```{r, include = FALSE}
# Heart-kidney

tissue_conserved_50_overlap(sort_humans_heart_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed)

# human_specific chimp_specific rhesus_specific   hc   hr   cr hcr_conserved
#          23347          11490           18947 4004 1871 1136          1069

# Heart liver
tissue_conserved_50_overlap(sort_humans_heart_liver_DMRs_bed, sort_chimps_heart_liver_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr hcr_conserved
#          13985          19127           34581 4887 1946 3010          1743
     
     
# Heat lung
tissue_conserved_50_overlap(sort_humans_heart_lung_DMRs_bed, sort_chimps_heart_lung_DMRs_bed, sort_rhesus_heart_lung_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#          12146           6541            6033 1422 432 353           208

# Liver lung
tissue_conserved_50_overlap(sort_humans_liver_lung_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed)

# human_specific chimp_specific rhesus_specific   hc   hr   cr hcr_conserved
#           7903          16113           28393 2877 1126 2181           936

# Liver-Kidney
tissue_conserved_50_overlap(sort_humans_liver_kidney_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc   hr   cr hcr_conserved
#          11494          16854           31118 3695 1494 2071          1227

# Lung-kidney
tissue_conserved_50_overlap(sort_humans_lung_kidney_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#          12857           8668           13692 2176 965 709           523
```



### 50% overlap in hypo methylated
```{r}
sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hypo"),]

# Heart-kidney

tissue_conserved_50_overlap(sort_humans_heart_kidney_DMRs_bed_hypo, sort_chimps_heart_kidney_DMRs_bed_hypo, sort_rhesus_heart_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#          10210           5531            8220 1567 684 489           391

# Heart liver

sort_humans_heart_liver_DMRs_bed_hypo <- sort_humans_heart_liver_DMRs_bed[which(sort_humans_heart_liver_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_liver_DMRs_bed_hypo <- sort_chimps_heart_liver_DMRs_bed[which(sort_chimps_heart_liver_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_liver_DMRs_bed_hypo <- sort_rhesus_heart_liver_DMRs_bed[which(sort_rhesus_heart_liver_DMRs_bed[,4] == "hypo"),]

tissue_conserved_50_overlap(sort_humans_heart_liver_DMRs_bed_hypo, sort_chimps_heart_liver_DMRs_bed_hypo, sort_rhesus_heart_liver_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#           7751           9006           15407 2128 959 1573           857
     
     
# Heat lung

sort_humans_heart_lung_DMRs_bed_hypo <- sort_humans_heart_lung_DMRs_bed[which(sort_humans_heart_lung_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_lung_DMRs_bed_hypo <- sort_chimps_heart_lung_DMRs_bed[which(sort_chimps_heart_lung_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_lung_DMRs_bed_hypo <- sort_rhesus_heart_lung_DMRs_bed[which(sort_rhesus_heart_lung_DMRs_bed[,4] == "hypo"),]

tissue_conserved_50_overlap(sort_humans_heart_lung_DMRs_bed_hypo, sort_chimps_heart_lung_DMRs_bed_hypo, sort_rhesus_heart_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#           8060           4013            3428 1003 269 215           156



# Liver lung
sort_humans_liver_lung_DMRs_bed_hypo <- sort_humans_liver_lung_DMRs_bed[which(sort_humans_liver_lung_DMRs_bed[,4] == "hypo"),]

sort_chimps_liver_lung_DMRs_bed_hypo <- sort_chimps_liver_lung_DMRs_bed[which(sort_chimps_liver_lung_DMRs_bed[,4] == "hypo"),]

sort_rhesus_liver_lung_DMRs_bed_hypo <- sort_rhesus_liver_lung_DMRs_bed[which(sort_rhesus_liver_lung_DMRs_bed[,4] == "hypo"),]

tissue_conserved_50_overlap(sort_humans_liver_lung_DMRs_bed_hypo, sort_chimps_liver_lung_DMRs_bed_hypo, sort_rhesus_liver_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#           4606          10236           16810 2120 704 1301           660


# Liver-Kidney
sort_humans_liver_kidney_DMRs_bed_hypo <- sort_humans_liver_kidney_DMRs_bed[which(sort_humans_liver_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_liver_kidney_DMRs_bed_hypo <- sort_chimps_liver_kidney_DMRs_bed[which(sort_chimps_liver_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_liver_kidney_DMRs_bed_hypo <- sort_rhesus_liver_kidney_DMRs_bed[which(sort_rhesus_liver_kidney_DMRs_bed[,4] == "hypo"),]

tissue_conserved_50_overlap(sort_humans_liver_kidney_DMRs_bed_hypo, sort_chimps_liver_kidney_DMRs_bed_hypo, sort_rhesus_liver_kidney_DMRs_bed_hypo)

#    human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#           3953           8779           16541 1484 507 1021           424

# Lung-kidney

sort_humans_lung_kidney_DMRs_bed_hypo <- sort_humans_lung_kidney_DMRs_bed[which(sort_humans_lung_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_lung_kidney_DMRs_bed_hypo <- sort_chimps_lung_kidney_DMRs_bed[which(sort_chimps_lung_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_lung_kidney_DMRs_bed_hypo <- sort_rhesus_lung_kidney_DMRs_bed[which(sort_rhesus_lung_kidney_DMRs_bed[,4] == "hypo"),]

tissue_conserved_50_overlap(sort_humans_lung_kidney_DMRs_bed_hypo, sort_chimps_lung_kidney_DMRs_bed_hypo, sort_rhesus_lung_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#           3625           3115            5058 458 226 215           112
```


### 50% overlap in hyper methylated
```{r}
sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hyper"),]

# Heart-kidney

tissue_conserved_50_overlap(sort_humans_heart_kidney_DMRs_bed_hypo, sort_chimps_heart_kidney_DMRs_bed_hypo, sort_rhesus_heart_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr hcr_conserved
#          13154           5974           10760     2439 1171 633           675

# Heart liver

sort_humans_heart_liver_DMRs_bed_hypo <- sort_humans_heart_liver_DMRs_bed[which(sort_humans_heart_liver_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_liver_DMRs_bed_hypo <- sort_chimps_heart_liver_DMRs_bed[which(sort_chimps_heart_liver_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_liver_DMRs_bed_hypo <- sort_rhesus_heart_liver_DMRs_bed[which(sort_rhesus_heart_liver_DMRs_bed[,4] == "hyper"),]

tissue_conserved_50_overlap(sort_humans_heart_liver_DMRs_bed_hypo, sort_chimps_heart_liver_DMRs_bed_hypo, sort_rhesus_heart_liver_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#           6271          10161           19254     2766 954 1401           875
     
     
# Heart lung

sort_humans_heart_lung_DMRs_bed_hypo <- sort_humans_heart_lung_DMRs_bed[which(sort_humans_heart_lung_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_lung_DMRs_bed_hypo <- sort_chimps_heart_lung_DMRs_bed[which(sort_chimps_heart_lung_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_lung_DMRs_bed_hypo <- sort_rhesus_heart_lung_DMRs_bed[which(sort_rhesus_heart_lung_DMRs_bed[,4] == "hyper"),]

tissue_conserved_50_overlap(sort_humans_heart_lung_DMRs_bed_hypo, sort_chimps_heart_lung_DMRs_bed_hypo, sort_rhesus_heart_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#          4099           2533            2619      417 152 135            52

# Liver lung
sort_humans_liver_lung_DMRs_bed_hypo <- sort_humans_liver_lung_DMRs_bed[which(sort_humans_liver_lung_DMRs_bed[,4] == "hyper"),]

sort_chimps_liver_lung_DMRs_bed_hypo <- sort_chimps_liver_lung_DMRs_bed[which(sort_chimps_liver_lung_DMRs_bed[,4] == "hyper"),]

sort_rhesus_liver_lung_DMRs_bed_hypo <- sort_rhesus_liver_lung_DMRs_bed[which(sort_rhesus_liver_lung_DMRs_bed[,4] == "hyper"),]

tissue_conserved_50_overlap(sort_humans_liver_lung_DMRs_bed_hypo, sort_chimps_liver_lung_DMRs_bed_hypo, sort_rhesus_liver_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#           3318           5910           11633     757 405 851           272


# Liver-Kidney
sort_humans_liver_kidney_DMRs_bed_hypo <- sort_humans_liver_kidney_DMRs_bed[which(sort_humans_liver_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_liver_kidney_DMRs_bed_hypo <- sort_chimps_liver_kidney_DMRs_bed[which(sort_chimps_liver_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_liver_kidney_DMRs_bed_hypo <- sort_rhesus_liver_kidney_DMRs_bed[which(sort_rhesus_liver_kidney_DMRs_bed[,4] == "hyper"),]

tissue_conserved_50_overlap(sort_humans_liver_kidney_DMRs_bed_hypo, sort_chimps_liver_kidney_DMRs_bed_hypo, sort_rhesus_liver_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#           7564           8104           14626     2210 966 1023           802

# Lung-kidney

sort_humans_lung_kidney_DMRs_bed_hypo <- sort_humans_lung_kidney_DMRs_bed[which(sort_humans_lung_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_lung_kidney_DMRs_bed_hypo <- sort_chimps_lung_kidney_DMRs_bed[which(sort_chimps_lung_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_lung_kidney_DMRs_bed_hypo <- sort_rhesus_lung_kidney_DMRs_bed[which(sort_rhesus_lung_kidney_DMRs_bed[,4] == "hyper"),]

tissue_conserved_50_overlap(sort_humans_lung_kidney_DMRs_bed_hypo, sort_chimps_lung_kidney_DMRs_bed_hypo, sort_rhesus_lung_kidney_DMRs_bed_hypo)

#    human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#           9239           5561            8648     1718 733 487           410
```



### 75% overlap
```{r, include = FALSE}
# Heart-kidney

tissue_conserved_75_overlap(sort_humans_heart_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#          27052          14759           21413     2171 841 542           227

# Heart liver
tissue_conserved_75_overlap(sort_humans_heart_liver_DMRs_bed, sort_chimps_heart_liver_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#          18396          24190           38680     2893 916 1328           356
     
     
# Heat lung
tissue_conserved_75_overlap(sort_humans_heart_lung_DMRs_bed, sort_chimps_heart_lung_DMRs_bed, sort_rhesus_heart_lung_DMRs_bed)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#          13329           7657            6653     666 172 160            41

# Liver lung
tissue_conserved_75_overlap(sort_humans_liver_lung_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed)

 #    human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#          10506          19337           31060     1674 480 914           182

# Liver-Kidney
tissue_conserved_75_overlap(sort_humans_liver_kidney_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#          14859          20569           34034     2090 688 915           273

# Lung-kidney
tissue_conserved_75_overlap(sort_humans_lung_kidney_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

#     human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#          14857          10491           15016     1136 424 345           104
```



### 75% overlap in hypo methylated
```{r}
sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hypo"),]

# Heart-kidney

tissue_conserved_75_overlap(sort_humans_heart_kidney_DMRs_bed_hypo, sort_chimps_heart_kidney_DMRs_bed_hypo, sort_rhesus_heart_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#          11629           6861            9165     824 326 220            73

# Heart liver

sort_humans_heart_liver_DMRs_bed_hypo <- sort_humans_heart_liver_DMRs_bed[which(sort_humans_heart_liver_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_liver_DMRs_bed_hypo <- sort_chimps_heart_liver_DMRs_bed[which(sort_chimps_heart_liver_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_liver_DMRs_bed_hypo <- sort_rhesus_heart_liver_DMRs_bed[which(sort_rhesus_heart_liver_DMRs_bed[,4] == "hypo"),]

tissue_conserved_75_overlap(sort_humans_heart_liver_DMRs_bed_hypo, sort_chimps_heart_liver_DMRs_bed_hypo, sort_rhesus_heart_liver_DMRs_bed_hypo)

#    human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#           9826          11434           17440     1232 458 719           179
     
# Heart lung

sort_humans_heart_lung_DMRs_bed_hypo <- sort_humans_heart_lung_DMRs_bed[which(sort_humans_heart_lung_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_lung_DMRs_bed_hypo <- sort_chimps_heart_lung_DMRs_bed[which(sort_chimps_heart_lung_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_lung_DMRs_bed_hypo <- sort_rhesus_heart_lung_DMRs_bed[which(sort_rhesus_heart_lung_DMRs_bed[,4] == "hypo"),]

tissue_conserved_75_overlap(sort_humans_heart_lung_DMRs_bed_hypo, sort_chimps_heart_lung_DMRs_bed_hypo, sort_rhesus_heart_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#           8858           4758            3809     484 114 113            32



# Liver lung
sort_humans_liver_lung_DMRs_bed_hypo <- sort_humans_liver_lung_DMRs_bed[which(sort_humans_liver_lung_DMRs_bed[,4] == "hypo"),]

sort_chimps_liver_lung_DMRs_bed_hypo <- sort_chimps_liver_lung_DMRs_bed[which(sort_chimps_liver_lung_DMRs_bed[,4] == "hypo"),]

sort_rhesus_liver_lung_DMRs_bed_hypo <- sort_rhesus_liver_lung_DMRs_bed[which(sort_rhesus_liver_lung_DMRs_bed[,4] == "hypo"),]

tissue_conserved_75_overlap(sort_humans_liver_lung_DMRs_bed_hypo, sort_chimps_liver_lung_DMRs_bed_hypo, sort_rhesus_liver_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#           6407          12383           18470     1241 312 563           130


# Liver-Kidney
sort_humans_liver_kidney_DMRs_bed_hypo <- sort_humans_liver_kidney_DMRs_bed[which(sort_humans_liver_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_liver_kidney_DMRs_bed_hypo <- sort_chimps_liver_kidney_DMRs_bed[which(sort_chimps_liver_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_liver_kidney_DMRs_bed_hypo <- sort_rhesus_liver_kidney_DMRs_bed[which(sort_rhesus_liver_kidney_DMRs_bed[,4] == "hypo"),]

tissue_conserved_75_overlap(sort_humans_liver_kidney_DMRs_bed_hypo, sort_chimps_liver_kidney_DMRs_bed_hypo, sort_rhesus_liver_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#           5224          10401           17791     834 229 392            81

# Lung-kidney

sort_humans_lung_kidney_DMRs_bed_hypo <- sort_humans_lung_kidney_DMRs_bed[which(sort_humans_lung_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_lung_kidney_DMRs_bed_hypo <- sort_chimps_lung_kidney_DMRs_bed[which(sort_chimps_lung_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_lung_kidney_DMRs_bed_hypo <- sort_rhesus_lung_kidney_DMRs_bed[which(sort_rhesus_lung_kidney_DMRs_bed[,4] == "hypo"),]

tissue_conserved_75_overlap(sort_humans_lung_kidney_DMRs_bed_hypo, sort_chimps_lung_kidney_DMRs_bed_hypo, sort_rhesus_lung_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr cr hcr_conserved
#           4075           3561            5391 224 105 98            17
```


### 75% overlap in hyper methylated
```{r}
sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hyper"),]

# Heart-kidney

tissue_conserved_75_overlap(sort_humans_heart_kidney_DMRs_bed_hypo, sort_chimps_heart_kidney_DMRs_bed_hypo, sort_rhesus_heart_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc   hr  cr hcr_conserved
#                15427           7903           12258 1348 511 317           153

# Heart liver

sort_humans_heart_liver_DMRs_bed_hypo <- sort_humans_heart_liver_DMRs_bed[which(sort_humans_heart_liver_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_liver_DMRs_bed_hypo <- sort_chimps_heart_liver_DMRs_bed[which(sort_chimps_heart_liver_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_liver_DMRs_bed_hypo <- sort_rhesus_heart_liver_DMRs_bed[which(sort_rhesus_heart_liver_DMRs_bed[,4] == "hyper"),]

tissue_conserved_75_overlap(sort_humans_heart_liver_DMRs_bed_hypo, sort_chimps_heart_liver_DMRs_bed_hypo, sort_rhesus_heart_liver_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#                8581          12772           21264 1660 449 595           176
     
     
# Heart lung

sort_humans_heart_lung_DMRs_bed_hypo <- sort_humans_heart_lung_DMRs_bed[which(sort_humans_heart_lung_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_lung_DMRs_bed_hypo <- sort_chimps_heart_lung_DMRs_bed[which(sort_chimps_heart_lung_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_lung_DMRs_bed_hypo <- sort_rhesus_heart_lung_DMRs_bed[which(sort_rhesus_heart_lung_DMRs_bed[,4] == "hyper"),]

tissue_conserved_75_overlap(sort_humans_heart_lung_DMRs_bed_hypo, sort_chimps_heart_lung_DMRs_bed_hypo, sort_rhesus_heart_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#           4475           2901            2846       180 56 47             9

# Liver lung
sort_humans_liver_lung_DMRs_bed_hypo <- sort_humans_liver_lung_DMRs_bed[which(sort_humans_liver_lung_DMRs_bed[,4] == "hyper"),]

sort_chimps_liver_lung_DMRs_bed_hypo <- sort_chimps_liver_lung_DMRs_bed[which(sort_chimps_liver_lung_DMRs_bed[,4] == "hyper"),]

sort_rhesus_liver_lung_DMRs_bed_hypo <- sort_rhesus_liver_lung_DMRs_bed[which(sort_rhesus_liver_lung_DMRs_bed[,4] == "hyper"),]

tissue_conserved_75_overlap(sort_humans_liver_lung_DMRs_bed_hypo, sort_chimps_liver_lung_DMRs_bed_hypo, sort_rhesus_liver_lung_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#           4107           6960           12600     431 162 347            52


# Liver-Kidney
sort_humans_liver_kidney_DMRs_bed_hypo <- sort_humans_liver_kidney_DMRs_bed[which(sort_humans_liver_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_liver_kidney_DMRs_bed_hypo <- sort_chimps_liver_kidney_DMRs_bed[which(sort_chimps_liver_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_liver_kidney_DMRs_bed_hypo <- sort_rhesus_liver_kidney_DMRs_bed[which(sort_rhesus_liver_kidney_DMRs_bed[,4] == "hyper"),]

tissue_conserved_75_overlap(sort_humans_liver_kidney_DMRs_bed_hypo, sort_chimps_liver_kidney_DMRs_bed_hypo, sort_rhesus_liver_kidney_DMRs_bed_hypo)

#     human_specific chimp_specific rhesus_specific   hc  hr   cr hcr_conserved
#          9641          10178           16257        1255 454 514           192

# Lung-kidney

sort_humans_lung_kidney_DMRs_bed_hypo <- sort_humans_lung_kidney_DMRs_bed[which(sort_humans_lung_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_lung_kidney_DMRs_bed_hypo <- sort_chimps_lung_kidney_DMRs_bed[which(sort_chimps_lung_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_lung_kidney_DMRs_bed_hypo <- sort_rhesus_lung_kidney_DMRs_bed[which(sort_rhesus_lung_kidney_DMRs_bed[,4] == "hyper"),]

tissue_conserved_75_overlap(sort_humans_lung_kidney_DMRs_bed_hypo, sort_chimps_lung_kidney_DMRs_bed_hypo, sort_rhesus_lung_kidney_DMRs_bed_hypo)

#    human_specific chimp_specific rhesus_specific   hc  hr  cr hcr_conserved
#          10783           6934            9630       912 318 243            87
```



## Making plots

```{r}

# Hypo
#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]           9025           4520            7252 1964 1038 669
#     hcr_conserved
#[1,]           825

sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hypo"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hypo"),]

# Heart-kidney hypo
dev.off()
draw.triple.venn(nrow(sort_humans_heart_kidney_DMRs_bed_hypo), nrow(sort_chimps_heart_kidney_DMRs_bed_hypo), nrow(sort_rhesus_heart_kidney_DMRs_bed_hypo), 1964+825, 669+825, 1038+825, 825,  main= "Heart versus kidney (hypomethylated)",  category = c("Human", "Chimp", "Rhesus macaque"), height=3000, width=3000, cex=2 , fill = pal[1:3], lty=1, cat.cex = 2, main.cex = 2)


#Hyper
#     human_specific chimp_specific rhesus_specific   hc   hr  cr
#[1,]          11434           4582            9456 2949 1593 727
#     hcr_conserved
#[1,]          1463


sort_humans_heart_kidney_DMRs_bed_hypo <- sort_humans_heart_kidney_DMRs_bed[which(sort_humans_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_chimps_heart_kidney_DMRs_bed_hypo <- sort_chimps_heart_kidney_DMRs_bed[which(sort_chimps_heart_kidney_DMRs_bed[,4] == "hyper"),]

sort_rhesus_heart_kidney_DMRs_bed_hypo <- sort_rhesus_heart_kidney_DMRs_bed[which(sort_rhesus_heart_kidney_DMRs_bed[,4] == "hyper"),]

# # Other plots
dev.off()
draw.triple.venn(nrow(sort_humans_heart_kidney_DMRs_bed_hypo), nrow(sort_chimps_heart_kidney_DMRs_bed_hypo), nrow(sort_rhesus_heart_kidney_DMRs_bed_hypo), 2949+1463, 727+1463, 1593+1463, 1463,  main= "Heart versus kidney (hypomethylated)",  category = c("Human", "Chimp", "Rhesus macaque"), height=3000, width=3000, cex=2 , fill = pal[1:3], lty=1, cat.cex = 2, main.cex = 2)


dev.off()
draw.triple.venn(444+306+1083+200, 306+1083+577+457, 200+1083+577+947, 306+1083, 577+1083, 200+1083,1083,  main= "Heart versus kidney (hypomethylated)",  category = c("Human", "Chimp", "Rhesus macaque"), height=3000, width=3000, cex=2 , fill = pal[1:3], lty=1, cat.cex = 2, main.cex = 2)


```

```{r}
p1 <- ggdraw()+draw_image("../data/Hyper_heart_liver.svg")+draw_figure_label("11A.", size = 16, fontface = "bold")
p2 <- ggdraw()+draw_image("../data/Hypo_heart_liver.svg")+draw_figure_label("11B.", size = 16, fontface = "bold")

p3 <- ggdraw()+draw_image("../data/Hyper_heart_lung.svg")+draw_figure_label("11C.", size = 16, fontface = "bold")
p4 <- ggdraw()+draw_image("../data/Hypo_heart_lung.svg")+draw_figure_label("11D.", size = 16, fontface = "bold")

p5 <- ggdraw()+draw_image("../data/Hyper_heart_kidney.svg")+draw_figure_label("11E.", size = 16, fontface = "bold")
p6 <- ggdraw()+draw_image("../data/Hypo_heart_kidney.svg")+draw_figure_label("11F.", size = 16, fontface = "bold")

p7 <- ggdraw()+draw_image("../data/Hyper_liver_lung.svg")+draw_figure_label("11G.", size = 16, fontface = "bold")
p8 <- ggdraw()+draw_image("../data/Hypo_liver_lung.svg")+draw_figure_label("11H.", size = 16, fontface = "bold")

p9 <- ggdraw()+draw_image("../data/Hyper_liver_kidney.svg")+draw_figure_label("11I.", size = 16, fontface = "bold")
p10 <- ggdraw()+draw_image("../data/Hypo_liver_kidney.svg")+draw_figure_label("11J.", size = 16, fontface = "bold")

p11 <- ggdraw()+draw_image("../data/Hyper_lung_kidney.svg")+draw_figure_label("11K.", size = 16, fontface = "bold")
p12 <- ggdraw()+draw_image("../data/Hypo_lung_kidney.svg")+draw_figure_label("11L.", size = 16, fontface = "bold")


eight_plots <- plot_grid(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, ncol = 4)
plot_supp_fig <- plot_grid(eight_plots, ncol = 1, rel_heights=c(0.1, 1))


#save_plot("/Users/laurenblake/Dropbox/Quick_ref/Methylation/Hyper_hypo_pairwise.png", plot_supp_fig,
#          ncol = 4, # we're saving a grid plot of 2 columns
#          nrow = 3, # and 2 rows
          # each individual subplot should have an aspect ratio of 1.3
#          base_aspect_ratio = 0.75
#          )

```

