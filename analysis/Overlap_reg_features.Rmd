---
title: "Direction specific conserved versus human specific tDMRs"
author: "Lauren Blake"
date: "March 8, 2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

The goal of this analysis is to identify conserved versus human-specific tDMRs 

# Introduction

```{r}
# Import libraries

library("ggplot2")
library("VennDiagram")
library("plyr")
library("dplyr")
library("bedr")
library("RColorBrewer")
getwd()

colors <- colorRampPalette(c(brewer.pal(9, "Blues")[1],brewer.pal(9, "Blues")[9]))(100)
pal <- c(brewer.pal(9, "Set1"), brewer.pal(8, "Set2"), brewer.pal(12, "Set3"))


# Import the data

# Human tDMRs
humans_heart_kidney_DMRs <- read.delim("../data/humans_heart_kidney_DMRs.txt")
humans_heart_liver_DMRs <- read.delim("../data/humans_heart_liver_DMRs.txt")
humans_heart_lung_DMRs <- read.delim("../data/humans_heart_lung_DMRs.txt")
humans_liver_lung_DMRs <- read.delim("../data/humans_liver_lung_DMRs.txt")
humans_liver_kidney_DMRs <- read.delim("../data/humans_liver_kidney_DMRs.txt")
humans_lung_kidney_DMRs <- read.delim("../data/humans_lung_kidney_DMRs.txt")

levels(humans_lung_kidney_DMRs[,1])
#count(humans_lung_kidney_DMRs[,1])

# Chimp tDMRs
chimps_heart_kidney_DMRs <- read.delim("../data/chimps_heart_kidney_DMRs.txt")
chimps_heart_liver_DMRs <- read.delim("../data/chimps_heart_liver_DMRs.txt")
chimps_heart_lung_DMRs <- read.delim("../data/chimps_heart_lung_DMRs.txt")
chimps_liver_lung_DMRs <- read.delim("../data/chimps_liver_lung_DMRs.txt")
chimps_liver_kidney_DMRs <- read.delim("../data/chimps_liver_kidney_DMRs.txt")
chimps_lung_kidney_DMRs <- read.delim("../data/chimps_lung_kidney_DMRs.txt")

levels(chimps_lung_kidney_DMRs[,1])
#count(chimps_lung_kidney_DMRs[,1])

# Rhesus tDMRs

rhesus_heart_kidney_DMRs <- read.delim("../data/rhesus_heart_kidney_DMRs.txt")
rhesus_heart_liver_DMRs <- read.delim("../data/rhesus_heart_liver_DMRs.txt")
rhesus_heart_lung_DMRs <- read.delim("../data/rhesus_heart_lung_DMRs.txt")
rhesus_liver_lung_DMRs <- read.delim("../data/rhesus_liver_lung_DMRs.txt")
rhesus_liver_kidney_DMRs <- read.delim("../data/rhesus_liver_kidney_DMRs.txt")
rhesus_lung_kidney_DMRs <- read.delim("../data/rhesus_lung_kidney_DMRs.txt")

levels(rhesus_heart_kidney_DMRs[,1])
#count(rhesus_lung_kidney_DMRs[,1])
```


# Get human, chimp, and rhesus autosomal tDMRs and perform heart specific analysis as an example

```{r}
# Human heart-liver

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_heart_liver_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_humans_heart_liver_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# Human heart-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_heart_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_humans_heart_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# human heart-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_heart_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_humans_heart_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX, check.chr = FALSE)


# human liver-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_liver_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_humans_liver_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)


# human liver-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_liver_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_humans_liver_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# human lung-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- humans_lung_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])
summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_humans_lung_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

```




## Heart specific

## Heart specific in humans

```{r}
# 25% overlap

heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)



colnames(heart_liver_heart_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_heart_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_lung_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

head(heart_liver_heart_lung_only_75)
head(heart_liver_heart_kidney_only_75)
head(heart_liver_liver_kidney_only_75)
head(heart_liver_liver_lung_only_75)
head(heart_liver_lung_kidney_only_75)

human_heart_liver_DMR <- left_join(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, by= c("chr", "start")) %>% left_join(., heart_liver_liver_lung_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_liver_kidney_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_lung_kidney_only_75, by=c("chr", "start"))


human_DMR_heart_specific_25 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,16] > 0 & human_heart_liver_DMR[,23] < 1 & human_heart_liver_DMR[,30] < 1 & human_heart_liver_DMR[,37] < 1),]

dim(human_DMR_heart_specific_25)

# Same direction

human_DMR_heart_specific_25 <- human_DMR_heart_specific_25[which(human_DMR_heart_specific_25[,4] == human_DMR_heart_specific_25[,8]),]

human_DMR_heart_specific_25 <- human_DMR_heart_specific_25[which(human_DMR_heart_specific_25[,4] == human_DMR_heart_specific_25[,11]),]

human_DMR_heart_specific_25 <- human_DMR_heart_specific_25[which(human_DMR_heart_specific_25[,4] == human_DMR_heart_specific_25[,15]),]

## 50% overlap 

heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_heart_liver_DMR <- cbind(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, heart_liver_liver_lung_only_75, heart_liver_liver_kidney_only_75, heart_liver_lung_kidney_only_75)

human_DMR_heart_specific_50 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,18] > 0 & human_heart_liver_DMR[,27] < 1 & human_heart_liver_DMR[,36] < 1 & human_heart_liver_DMR[,45] < 1),]

dim(human_DMR_heart_specific_50)

human_DMR_heart_specific_50 <- human_DMR_heart_specific_50[which(human_DMR_heart_specific_50[,4] == human_DMR_heart_specific_50[,8]),]

human_DMR_heart_specific_50 <- human_DMR_heart_specific_50[which(human_DMR_heart_specific_50[,4] == human_DMR_heart_specific_50[,13]),]

human_DMR_heart_specific_50 <- human_DMR_heart_specific_50[which(human_DMR_heart_specific_50[,4] == human_DMR_heart_specific_50[,17]),]




heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_heart_liver_DMR <- cbind(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, heart_liver_liver_lung_only_75, heart_liver_liver_kidney_only_75, heart_liver_lung_kidney_only_75)

human_DMR_heart_specific_75 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,18] > 0 & human_heart_liver_DMR[,27] < 1 & human_heart_liver_DMR[,36] < 1 & human_heart_liver_DMR[,45] < 1),]

dim(human_DMR_heart_specific_75)

```



## Heart specific in chimps

```{r}
# Chimp heart-liver

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_heart_liver_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_chimps_heart_liver_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# Chimp heart-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_heart_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_chimps_heart_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# chimp heart-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_heart_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_chimps_heart_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX, check.chr = FALSE)


# Chimp liver-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_liver_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_chimps_liver_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)


# chimp liver-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_liver_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_chimps_liver_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# chimp lung-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- chimps_lung_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])
summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_chimps_lung_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)


# 25% overlap

heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)



colnames(heart_liver_heart_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_heart_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_lung_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_heart_liver_DMR <- left_join(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, by= c("chr", "start")) %>% left_join(., heart_liver_liver_lung_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_liver_kidney_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_lung_kidney_only_75, by=c("chr", "start"))


chimp_DMR_heart_specific_25 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,16] > 0 & human_heart_liver_DMR[,23] < 1 & human_heart_liver_DMR[,30] < 1 & human_heart_liver_DMR[,37] < 1),]

dim(chimp_DMR_heart_specific_25)








##### 50% overlap 

heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_heart_liver_DMR <- cbind(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, heart_liver_liver_lung_only_75, heart_liver_liver_kidney_only_75, heart_liver_lung_kidney_only_75)

chimp_DMR_heart_specific_50 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,18] > 0 & human_heart_liver_DMR[,27] < 1 & human_heart_liver_DMR[,36] < 1 & human_heart_liver_DMR[,45] < 1),]

dim(chimp_DMR_heart_specific_50)



##### 75% overlap 

heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_chimps_heart_liver_DMRs_bed, b = sort_chimps_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_heart_liver_DMR <- cbind(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, heart_liver_liver_lung_only_75, heart_liver_liver_kidney_only_75, heart_liver_lung_kidney_only_75)

chimp_DMR_heart_specific_75 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,18] > 0 & human_heart_liver_DMR[,27] < 1 & human_heart_liver_DMR[,36] < 1 & human_heart_liver_DMR[,45] < 1),]

dim(chimp_DMR_heart_specific_75)

```




## Heart specific in rhesus


```{r}
# Chimp heart-liver

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_heart_liver_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_rhesus_heart_liver_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# Chimp heart-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_heart_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_rhesus_heart_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# chimp heart-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_heart_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_rhesus_heart_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX, check.chr = FALSE)


# Chimp liver-lung

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_liver_lung_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_rhesus_liver_lung_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)


# chimp liver-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_liver_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

sort_rhesus_liver_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)

# chimp lung-kidney

# columns to pull
pull_col <- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed <- rhesus_lung_kidney_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != "chrX"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr11_gl000202_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

humans_heart_liver_DMRs_bed_noX <- humans_heart_liver_DMRs_bed_noX[which(humans_heart_liver_DMRs_bed_noX[,1] != "chr17_gl000204_random"),]

humans_heart_liver_DMRs_bed_noX[,1] <- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] <- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] <- as.integer(humans_heart_liver_DMRs_bed_noX[,3])
summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])

sort_rhesus_lung_kidney_DMRs_bed <- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)


# 25% overlap

heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)



colnames(heart_liver_heart_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_heart_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_lung_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_heart_liver_DMR <- left_join(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, by= c("chr", "start")) %>% left_join(., heart_liver_liver_lung_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_liver_kidney_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_lung_kidney_only_75, by=c("chr", "start"))


rhesus_DMR_heart_specific_25 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,16] > 0 & human_heart_liver_DMR[,23] < 1 & human_heart_liver_DMR[,30] < 1 & human_heart_liver_DMR[,37] < 1),]

dim(rhesus_DMR_heart_specific_25)




heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

human_heart_liver_DMR <- cbind(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, heart_liver_liver_lung_only_75, heart_liver_liver_kidney_only_75, heart_liver_lung_kidney_only_75)

rhesus_DMR_heart_specific_50 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,18] > 0 & human_heart_liver_DMR[,27] < 1 & human_heart_liver_DMR[,36] < 1 & human_heart_liver_DMR[,45] < 1),]

dim(rhesus_DMR_heart_specific_50)

##### 75% overlap 


heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_rhesus_heart_liver_DMRs_bed, b = sort_rhesus_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_heart_liver_DMR <- cbind(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, heart_liver_liver_lung_only_75, heart_liver_liver_kidney_only_75, heart_liver_lung_kidney_only_75)

rhesus_DMR_heart_specific_75 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,18] > 0 & human_heart_liver_DMR[,27] < 1 & human_heart_liver_DMR[,36] < 1 & human_heart_liver_DMR[,45] < 1),]

dim(rhesus_DMR_heart_specific_75)

```

# Generalize the code with a function

```{r}
### Write functions for identifying tissue-specific DMRs in a given species

# 25% overlap

tissue_specific_25_overlap <- function(DMR1_tissue_to_overlap, DMR2_tissue_to_overlap, DMR3_tissue_to_overlap, DMR4_no_overlap, DMR5_no_overlap, DMR6_no_overlap){
  
  # Translate variables to previously-used code
  sort_humans_heart_liver_DMRs_bed <- DMR1_tissue_to_overlap
  sort_humans_liver_lung_DMRs_bed <- DMR2_tissue_to_overlap
  sort_humans_liver_kidney_DMRs_bed <- DMR3_tissue_to_overlap
  sort_humans_heart_kidney_DMRs_bed <- DMR4_no_overlap
  sort_humans_heart_lung_DMRs_bed <- DMR5_no_overlap
  sort_humans_lung_kidney_DMRs_bed <- DMR6_no_overlap

  # Run bedtools to overlap  
heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)


  # Convert to same name
colnames(heart_liver_heart_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_heart_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_lung_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_heart_liver_DMR <- left_join(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, by= c("chr", "start")) %>% left_join(., heart_liver_liver_lung_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_liver_kidney_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_lung_kidney_only_75, by=c("chr", "start"))


DMR_tissue_specific_25 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,16] > 0 & human_heart_liver_DMR[,23] < 1 & human_heart_liver_DMR[,30] < 1 & human_heart_liver_DMR[,37] < 1),]

  return(DMR_tissue_specific_25)
}

# 50% overlap

tissue_specific_50_overlap <- function(DMR1_tissue_to_overlap, DMR2_tissue_to_overlap, DMR3_tissue_to_overlap, DMR4_no_overlap, DMR5_no_overlap, DMR6_no_overlap){
  
  # Translate variables to previously-used code
  sort_humans_heart_liver_DMRs_bed <- DMR1_tissue_to_overlap
  sort_humans_liver_lung_DMRs_bed <- DMR2_tissue_to_overlap
  sort_humans_liver_kidney_DMRs_bed <- DMR3_tissue_to_overlap
  sort_humans_heart_kidney_DMRs_bed <- DMR4_no_overlap
  sort_humans_heart_lung_DMRs_bed <- DMR5_no_overlap
  sort_humans_lung_kidney_DMRs_bed <- DMR6_no_overlap

  # Run bedtools to overlap  
heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.5 -F 0.5", check.chr = FALSE)


  # Convert to same name
colnames(heart_liver_heart_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_heart_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_lung_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_heart_liver_DMR <- left_join(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, by= c("chr", "start")) %>% left_join(., heart_liver_liver_lung_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_liver_kidney_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_lung_kidney_only_75, by=c("chr", "start"))


DMR_tissue_specific_50 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,16] > 0 & human_heart_liver_DMR[,23] < 1 & human_heart_liver_DMR[,30] < 1 & human_heart_liver_DMR[,37] < 1),]

  return(DMR_tissue_specific_50)
}



# 75% overlap

tissue_specific_75_overlap <- function(DMR1_tissue_to_overlap, DMR2_tissue_to_overlap, DMR3_tissue_to_overlap, DMR4_no_overlap, DMR5_no_overlap, DMR6_no_overlap){
  
  # Translate variables to previously-used code
  sort_humans_heart_liver_DMRs_bed <- DMR1_tissue_to_overlap
  sort_humans_liver_lung_DMRs_bed <- DMR2_tissue_to_overlap
  sort_humans_liver_kidney_DMRs_bed <- DMR3_tissue_to_overlap
  sort_humans_heart_kidney_DMRs_bed <- DMR4_no_overlap
  sort_humans_heart_lung_DMRs_bed <- DMR5_no_overlap
  sort_humans_lung_kidney_DMRs_bed <- DMR6_no_overlap

  # Run bedtools to overlap  
heart_liver_heart_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_heart_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_liver_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_liver_lung_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_liver_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_lung_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

heart_liver_lung_kidney_only_75 <- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_lung_kidney_DMRs_bed), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)


  # Convert to same name
colnames(heart_liver_heart_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_heart_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_lung_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_liver_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(heart_liver_lung_kidney_only_75) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_heart_liver_DMR <- left_join(heart_liver_heart_lung_only_75, heart_liver_heart_kidney_only_75, by= c("chr", "start")) %>% left_join(., heart_liver_liver_lung_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_liver_kidney_only_75, by=c("chr", "start")) %>% left_join(., heart_liver_lung_kidney_only_75, by=c("chr", "start"))


DMR_tissue_specific_75 <- human_heart_liver_DMR[which(human_heart_liver_DMR[,9] > 0 & human_heart_liver_DMR[,16] > 0 & human_heart_liver_DMR[,23] < 1 & human_heart_liver_DMR[,30] < 1 & human_heart_liver_DMR[,37] < 1),]

  return(DMR_tissue_specific_75)
}
```

# Heart specific- all species

```{r}
# Make a function to confirm direction. Note, this will be different for each tissue

heart_specific_direction <- function(filename_from_tissue_specific_overlap_function){
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,8]),]
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,11]),]
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,15]),]
return(filename_from_tissue_specific_overlap_function)
  }
  
  
  
  
# Human heart specific

human_heart_specific_25 <- tissue_specific_25_overlap(sort_humans_heart_liver_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_heart_specific_25) # 2949

human_heart_specific_25 <- tissue_specific_25_overlap(sort_humans_heart_lung_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_heart_specific_25) #2969

human_heart_specific_25 <- tissue_specific_25_overlap(sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_heart_specific_25) #2965

## 25% overlap
human_heart_specific_25 <- tissue_specific_25_overlap(sort_humans_heart_lung_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_heart_specific_25)

human_heart_specific_25 <- heart_specific_direction(human_heart_specific_25)
dim(human_heart_specific_25)

# Note: for recording #, consider using merged
#nrow(bedr.merge.region(human_DMR_heart_specific_25[,1:4]))


# 50% 

human_heart_specific_50 <- tissue_specific_50_overlap(sort_humans_heart_lung_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_heart_specific_50)

human_heart_specific_50 <- heart_specific_direction(human_heart_specific_50)
dim(human_heart_specific_50)


# 75% 

human_heart_specific_75 <- tissue_specific_75_overlap(sort_humans_heart_lung_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_heart_specific_75)

human_heart_specific_75 <- heart_specific_direction(human_heart_specific_75)
dim(human_heart_specific_75)



# Chimp heart specific- 25%

chimp_heart_specific_25 <- tissue_specific_25_overlap(sort_chimps_heart_lung_DMRs_bed, sort_chimps_heart_liver_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed)

dim(chimp_heart_specific_25)

# Same direction

chimp_heart_specific_25 <- heart_specific_direction(chimp_heart_specific_25)
dim(chimp_heart_specific_25)

#nrow(bedr.merge.region(chimp_DMR_heart_specific_25[,1:4]))

# Chimp heart specific- 50%

chimp_heart_specific_50 <- tissue_specific_50_overlap(sort_chimps_heart_lung_DMRs_bed, sort_chimps_heart_liver_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed)

dim(chimp_heart_specific_50)
chimp_heart_specific_50 <- heart_specific_direction(chimp_heart_specific_50)
dim(chimp_heart_specific_50)

#nrow(bedr.merge.region(chimp_DMR_heart_specific_50[,1:4]))


# Chimp heart specific- 75%

chimp_heart_specific_75 <- tissue_specific_75_overlap(sort_chimps_heart_lung_DMRs_bed, sort_chimps_heart_liver_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed)

dim(chimp_heart_specific_75)

# Same direction
chimp_heart_specific_75 <- heart_specific_direction(chimp_heart_specific_75)
dim(chimp_heart_specific_75)






# Rhesus heart specific- 25%

rhesus_heart_specific_25 <- tissue_specific_25_overlap(sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

dim(rhesus_heart_specific_25)

# Same direction

rhesus_heart_specific_25 <- heart_specific_direction(rhesus_heart_specific_25)
dim(rhesus_heart_specific_25)


# Rhesus heart specific- 50%

rhesus_heart_specific_50 <- tissue_specific_50_overlap(sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

dim(rhesus_heart_specific_50)

# Same direction

rhesus_heart_specific_50 <- heart_specific_direction(rhesus_heart_specific_50)
dim(rhesus_heart_specific_50)


# Rhesus heart specific- 75%

rhesus_heart_specific_75 <- tissue_specific_75_overlap(sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

dim(rhesus_heart_specific_75)

# Same direction

rhesus_heart_specific_75 <- heart_specific_direction(rhesus_heart_specific_75)
dim(rhesus_heart_specific_75)
```


# Liver specific- all species

```{r}
# Make a function to confirm direction. Note, this will be different for each tissue

liver_specific_direction <- function(filename_from_tissue_specific_overlap_function){
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,8]),]
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,11]),]
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] != filename_from_tissue_specific_overlap_function[,15]),]
return(filename_from_tissue_specific_overlap_function)
  }
  

  
  
# Human liver specific

human_liver_specific_25 <- tissue_specific_25_overlap(sort_humans_liver_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_liver_specific_25) #3276

human_liver_specific_25 <- tissue_specific_25_overlap(sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_liver_specific_25) #3293

human_liver_specific_25 <- tissue_specific_25_overlap(sort_humans_heart_liver_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_liver_specific_25) #3280

## 25% overlap
human_liver_specific_25 <- tissue_specific_25_overlap(sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_liver_specific_25)

human_liver_specific_25 <- liver_specific_direction(human_liver_specific_25)
dim(human_liver_specific_25)

# Note: for recording #, consider using merged
#nrow(bedr.merge.region(human_DMR_heart_specific_25[,1:4]))


# 50% 

human_liver_specific_50 <- tissue_specific_50_overlap(sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_liver_specific_50)

human_liver_specific_50 <- liver_specific_direction(human_liver_specific_50)
dim(human_liver_specific_50)


# 75% 

human_liver_specific_75 <- tissue_specific_75_overlap(sort_humans_liver_lung_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_kidney_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed)

dim(human_liver_specific_75)

human_liver_specific_75 <- liver_specific_direction(human_liver_specific_75)
dim(human_liver_specific_75)



# Chimp heart specific- 25%

chimp_liver_specific_25 <- tissue_specific_25_overlap(sort_chimps_liver_lung_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_liver_DMRs_bed,  sort_chimps_heart_kidney_DMRs_bed, sort_chimps_heart_lung_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed)

dim(chimp_liver_specific_25)

chimp_liver_specific_25 <- liver_specific_direction(chimp_liver_specific_25)
dim(chimp_liver_specific_25)

# Chimp heart specific- 50%

chimp_liver_specific_50 <- tissue_specific_50_overlap(sort_chimps_liver_lung_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_liver_DMRs_bed,  sort_chimps_heart_kidney_DMRs_bed, sort_chimps_heart_lung_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed)

dim(chimp_liver_specific_50)

chimp_liver_specific_50 <- liver_specific_direction(chimp_liver_specific_50)
dim(chimp_liver_specific_50)


# Chimp heart specific- 75%

chimp_liver_specific_75 <- tissue_specific_75_overlap(sort_chimps_liver_lung_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_liver_DMRs_bed,  sort_chimps_heart_kidney_DMRs_bed, sort_chimps_heart_lung_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed)

dim(chimp_liver_specific_75)

chimp_liver_specific_75 <- liver_specific_direction(chimp_liver_specific_75)
dim(chimp_liver_specific_75)







# Rhesus heart specific- 25%

rhesus_liver_specific_25 <- tissue_specific_25_overlap(sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed,  sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

dim(rhesus_liver_specific_25)

rhesus_liver_specific_25 <- liver_specific_direction(rhesus_liver_specific_25)
dim(rhesus_liver_specific_25)



# Rhesus heart specific- 50%

rhesus_liver_specific_50 <- tissue_specific_50_overlap(sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed,  sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

dim(rhesus_liver_specific_50)

rhesus_liver_specific_50 <- liver_specific_direction(rhesus_liver_specific_50)
dim(rhesus_liver_specific_50)


# Rhesus heart specific- 75%

rhesus_liver_specific_75 <- tissue_specific_75_overlap(sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed,  sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed)

dim(rhesus_liver_specific_75)

rhesus_liver_specific_75 <- liver_specific_direction(rhesus_liver_specific_75)
dim(rhesus_liver_specific_75)

```

# Lung specific- all species

```{r}
# Make a function to confirm direction. Note, this will be different for each tissue

lung_specific_direction <- function(filename_from_tissue_specific_overlap_function){
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] != filename_from_tissue_specific_overlap_function[,8]),]
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,11]),]
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,15]),]
return(filename_from_tissue_specific_overlap_function)
  }
  

  
  
# Human lung specific

human_lung_specific_25 <- tissue_specific_25_overlap(sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_heart_liver_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed)

dim(human_lung_specific_25) #479

human_lung_specific_25 <- tissue_specific_25_overlap(sort_humans_lung_kidney_DMRs_bed, sort_humans_heart_lung_DMRs_bed, sort_humans_liver_lung_DMRs_bed,   sort_humans_heart_liver_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed)

dim(human_lung_specific_25) #469


human_lung_specific_25 <- tissue_specific_25_overlap(sort_humans_liver_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed, sort_humans_heart_lung_DMRs_bed,    sort_humans_heart_liver_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed)

dim(human_lung_specific_25) # 464

## 25% overlap

human_lung_specific_25 <- tissue_specific_25_overlap(sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed,   sort_humans_heart_liver_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed)

dim(human_lung_specific_25)

human_lung_specific_25 <- lung_specific_direction(human_lung_specific_25)
dim(human_lung_specific_25)


## 50% overlap

human_lung_specific_50 <- tissue_specific_50_overlap(sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed,   sort_humans_heart_liver_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed)

dim(human_lung_specific_50)

human_lung_specific_50 <- lung_specific_direction(human_lung_specific_50)
dim(human_lung_specific_50)


## 75% overlap

human_lung_specific_75 <- tissue_specific_75_overlap(sort_humans_heart_lung_DMRs_bed, sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed,   sort_humans_heart_liver_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed)

dim(human_lung_specific_75)

human_lung_specific_75 <- lung_specific_direction(human_lung_specific_75)
dim(human_lung_specific_75)


## Chimp liver specific

## 25% overlap

chimp_lung_specific_25 <- tissue_specific_25_overlap(sort_chimps_heart_lung_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed,   sort_chimps_heart_liver_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed)

dim(chimp_lung_specific_25)

chimp_lung_specific_25 <- lung_specific_direction(chimp_lung_specific_25)
dim(chimp_lung_specific_25)

## 50% overlap

chimp_lung_specific_50 <- tissue_specific_50_overlap(sort_chimps_heart_lung_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed,   sort_chimps_heart_liver_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed)

dim(chimp_lung_specific_50)

chimp_lung_specific_50 <- lung_specific_direction(chimp_lung_specific_50)
dim(chimp_lung_specific_50)

## 75% overlap

chimp_lung_specific_75 <- tissue_specific_75_overlap(sort_chimps_heart_lung_DMRs_bed, sort_chimps_lung_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed,   sort_chimps_heart_liver_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed)

dim(chimp_lung_specific_75)

chimp_lung_specific_75 <- lung_specific_direction(chimp_lung_specific_75)
dim(chimp_lung_specific_75)

# Rhesus lung specific

## 25% overlap

rhesus_lung_specific_25 <- tissue_specific_25_overlap(sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed,   sort_rhesus_heart_liver_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed)

dim(rhesus_lung_specific_25)

rhesus_lung_specific_25 <- lung_specific_direction(rhesus_lung_specific_25)
dim(rhesus_lung_specific_25)

## 50% overlap

rhesus_lung_specific_50 <- tissue_specific_50_overlap(sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed,   sort_rhesus_heart_liver_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed)

dim(rhesus_lung_specific_50)

rhesus_lung_specific_50 <- lung_specific_direction(rhesus_lung_specific_50)
dim(rhesus_lung_specific_50)

## 75% overlap

rhesus_lung_specific_75 <- tissue_specific_75_overlap(sort_rhesus_heart_lung_DMRs_bed, sort_rhesus_lung_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed,   sort_rhesus_heart_liver_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed)

dim(rhesus_lung_specific_75)

rhesus_lung_specific_75 <- lung_specific_direction(rhesus_lung_specific_75)
dim(rhesus_lung_specific_75)
```


# Kidney specific- all species

```{r}
# Make a function to confirm direction. Note, this will be different for each tissue

kidney_specific_direction <- function(filename_from_tissue_specific_overlap_function){
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,8]),]
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,11]),]
  filename_from_tissue_specific_overlap_function <- filename_from_tissue_specific_overlap_function[which(filename_from_tissue_specific_overlap_function[,4] == filename_from_tissue_specific_overlap_function[,15]),]
return(filename_from_tissue_specific_overlap_function)
  }
  

  
  
# Human kidney specific

human_kidney_specific_25 <- tissue_specific_25_overlap(sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_lung_DMRs_bed)

dim(human_kidney_specific_25) # 3968

human_kidney_specific_25 <- tissue_specific_25_overlap(sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_lung_DMRs_bed)

dim(human_kidney_specific_25) # 3940


human_kidney_specific_25 <- tissue_specific_25_overlap(sort_humans_heart_kidney_DMRs_bed, sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_lung_DMRs_bed)

dim(human_kidney_specific_25)  # 3962


## 25% overlap

human_kidney_specific_25 <- tissue_specific_25_overlap(sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_lung_DMRs_bed)

dim(human_kidney_specific_25)

human_kidney_specific_25 <- kidney_specific_direction(human_kidney_specific_25)
dim(human_kidney_specific_25)

## 50% overlap

human_kidney_specific_50 <- tissue_specific_50_overlap(sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_lung_DMRs_bed)

dim(human_kidney_specific_50)

human_kidney_specific_50 <- kidney_specific_direction(human_kidney_specific_50)
dim(human_kidney_specific_50)

## 75% overlap

human_kidney_specific_75 <- tissue_specific_75_overlap(sort_humans_lung_kidney_DMRs_bed, sort_humans_liver_kidney_DMRs_bed, sort_humans_heart_kidney_DMRs_bed, sort_humans_liver_lung_DMRs_bed, sort_humans_heart_liver_DMRs_bed,  sort_humans_heart_lung_DMRs_bed)

dim(human_kidney_specific_75)

human_kidney_specific_75 <- kidney_specific_direction(human_kidney_specific_75)
dim(human_kidney_specific_75)

# Chimp kidney specific

## 25% overlap

chimp_kidney_specific_25 <- tissue_specific_25_overlap(sort_chimps_lung_kidney_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_chimps_heart_liver_DMRs_bed,  sort_chimps_heart_lung_DMRs_bed)

dim(chimp_kidney_specific_25)

chimp_kidney_specific_25 <- kidney_specific_direction(chimp_kidney_specific_25)
dim(chimp_kidney_specific_25)

## 50% overlap

chimp_kidney_specific_50 <- tissue_specific_50_overlap(sort_chimps_lung_kidney_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_chimps_heart_liver_DMRs_bed,  sort_chimps_heart_lung_DMRs_bed)

dim(chimp_kidney_specific_50)

chimp_kidney_specific_50 <- kidney_specific_direction(chimp_kidney_specific_50)
dim(chimp_kidney_specific_50)

## 75% overlap

chimp_kidney_specific_75 <- tissue_specific_75_overlap(sort_chimps_lung_kidney_DMRs_bed, sort_chimps_liver_kidney_DMRs_bed, sort_chimps_heart_kidney_DMRs_bed, sort_chimps_liver_lung_DMRs_bed, sort_chimps_heart_liver_DMRs_bed,  sort_chimps_heart_lung_DMRs_bed)

dim(chimp_kidney_specific_75)

chimp_kidney_specific_75 <- kidney_specific_direction(chimp_kidney_specific_75)
dim(chimp_kidney_specific_75)


# Rhesus kidney specific

## 25% overlap

rhesus_kidney_specific_25 <- tissue_specific_25_overlap(sort_rhesus_lung_kidney_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed,  sort_rhesus_heart_lung_DMRs_bed)

dim(rhesus_kidney_specific_25)

rhesus_kidney_specific_25 <- kidney_specific_direction(rhesus_kidney_specific_25)
dim(rhesus_kidney_specific_25)

## 50% overlap

rhesus_kidney_specific_50 <- tissue_specific_50_overlap(sort_rhesus_lung_kidney_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed,  sort_rhesus_heart_lung_DMRs_bed)

dim(rhesus_kidney_specific_50)

rhesus_kidney_specific_50 <- kidney_specific_direction(rhesus_kidney_specific_50)
dim(rhesus_kidney_specific_50)

## 75% overlap

rhesus_kidney_specific_75 <- tissue_specific_75_overlap(sort_rhesus_lung_kidney_DMRs_bed, sort_rhesus_liver_kidney_DMRs_bed, sort_rhesus_heart_kidney_DMRs_bed, sort_rhesus_liver_lung_DMRs_bed, sort_rhesus_heart_liver_DMRs_bed,  sort_rhesus_heart_lung_DMRs_bed)

dim(rhesus_kidney_specific_75)

rhesus_kidney_specific_75 <- kidney_specific_direction(rhesus_kidney_specific_75)
dim(rhesus_kidney_specific_75)
```


## Heart specific: Conserved versus human specific 

```{r}
### 25% overlap

human_chimp_heart_specific_25 <- bedr(input = list(a = human_heart_specific_25[,1:4], b = chimp_heart_specific_25[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

# Human-chimp conserved

human_chimp_heart_specific_25_hs <- human_chimp_heart_specific_25[which(human_chimp_heart_specific_25[,9] == 0), ]
colnames(human_chimp_heart_specific_25_hs) <- c("chr", "start", "end")
human_chimp_heart_specific_25_conserved <- human_chimp_heart_specific_25[which(human_chimp_heart_specific_25[,9] > 0), ]

#write.table(human_chimp_heart_specific_25_hs[,1:4], "../data/human_chimp_heart_specific_25_hs.bed", quote = FALSE, row.names = FALSE, sep = "\t")

human_chimp_heart_specific_25_conserved <- human_chimp_heart_specific_25_conserved[which(human_chimp_heart_specific_25_conserved[,4] == human_chimp_heart_specific_25_conserved[,8]),]

#write.table(human_chimp_heart_specific_25_conserved[,1:4], "../data/human_chimp_heart_specific_25_conserved.bed", quote = FALSE, row.names = FALSE, sep = "\t")

# Human-chimp-rhesus 

human_rhesus_heart_specific_25 <- bedr(input = list(a = human_heart_specific_25[,1:4], b = rhesus_heart_specific_25[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

colnames(human_chimp_heart_specific_25) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_heart_specific_25) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")


human_chimp_rhesus_heart_specific_25 <- left_join(human_chimp_heart_specific_25, human_rhesus_heart_specific_25, by= c("chr", "start")) 

# Human-chimp-rhesus conserved

human_chimp_rhesus_heart_specific_25_hs <- human_chimp_rhesus_heart_specific_25[which(human_chimp_rhesus_heart_specific_25[,9] == 0 & human_chimp_rhesus_heart_specific_25[,16] == 0), ]

#write.table(human_chimp_rhesus_heart_specific_25_hs[,1:4], "../data/human_chimp_rhesus_heart_specific_25_hs.bed", quote = FALSE, row.names = FALSE, sep = "\t")

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25[which(human_chimp_rhesus_heart_specific_25[,9] > 0 & human_chimp_rhesus_heart_specific_25[,16] > 0),]

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25_conserved[which(human_chimp_rhesus_heart_specific_25_conserved[,4] == human_chimp_rhesus_heart_specific_25_conserved[,8]),]

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25_conserved[which(human_chimp_rhesus_heart_specific_25_conserved[,11] == human_chimp_rhesus_heart_specific_25_conserved[,15]),]

#write.table(human_chimp_rhesus_heart_specific_25_conserved[,1:4], "../data/human_chimp_rhesus_heart_specific_25_conserved.bed", quote = FALSE, row.names = FALSE, sep = "\t")

# Make a Venn diagram of the overlap






### 50% overlap

human_chimp_heart_specific_50 <- bedr(input = list(a = human_DMR_heart_specific_50[,1:4], b = chimp_DMR_heart_specific_50[,1:4]), method = "intersect",  params = "-wao -f 0.50 -F 0.50", check.chr = FALSE)

# Human-chimp conserved

human_chimp_heart_specific_50_hs <- human_chimp_heart_specific_50[which(human_chimp_heart_specific_50[,9] == 0), ]

human_chimp_heart_specific_50_conserved <- human_chimp_heart_specific_50[which(human_chimp_heart_specific_50[,9] > 0), ]

human_chimp_heart_specific_50_conserved <- human_chimp_heart_specific_50_conserved[which(human_chimp_heart_specific_50_conserved[,4] == human_chimp_heart_specific_50_conserved[,8]),]



# Human-chimp-rhesus 

human_rhesus_heart_specific_50 <- bedr(input = list(a = human_DMR_heart_specific_50[,1:4], b = rhesus_DMR_heart_specific_50[,1:4]), method = "intersect",  params = "-wao -f 0.50 -F 0.50", check.chr = FALSE)

human_chimp_rhesus_heart_specific_50 <- cbind(human_chimp_heart_specific_50, human_rhesus_heart_specific_50)

# Human-chimp-rhesus-conserved

human_chimp_rhesus_heart_specific_50_hs <- human_chimp_rhesus_heart_specific_50[which(human_chimp_rhesus_heart_specific_50[,9] == 0 & human_chimp_rhesus_heart_specific_50[,18] == 0), ]

human_chimp_rhesus_heart_specific_50_conserved <- human_chimp_rhesus_heart_specific_50[which(human_chimp_rhesus_heart_specific_50[,9] > 0 & human_chimp_rhesus_heart_specific_50[,18] > 0),]

human_chimp_rhesus_heart_specific_50_conserved <- human_chimp_rhesus_heart_specific_50_conserved[which(human_chimp_rhesus_heart_specific_50_conserved[,9] == human_chimp_rhesus_heart_specific_50_conserved[,18]),]

human_chimp_rhesus_heart_specific_50_conserved <- human_chimp_rhesus_heart_specific_50_conserved[which(human_chimp_rhesus_heart_specific_50_conserved[,9] == human_chimp_rhesus_heart_specific_50_conserved[,18]),]

#write.table(human_chimp_heart_specific_50_hs[,1:4], "../data/human_chimp_heart_specific_50_hs.bed", quote = FALSE, row.names = FALSE, sep = "\t")

summary(human_chimp_heart_specific_50_hs[,3]-human_chimp_heart_specific_50_hs[,2])

#write.table(human_chimp_heart_specific_50_conserved[,1:4], "../data/human_chimp_heart_specific_50_conserved.bed", quote = FALSE, row.names = FALSE, sep = "\t")

summary(human_chimp_heart_specific_50_conserved[,3]-human_chimp_heart_specific_50_conserved[,2])

### 75% overlap

human_chimp_heart_specific_75 <- bedr(input = list(a = human_DMR_heart_specific_75[,1:4], b = chimp_DMR_heart_specific_75[,1:4]), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

# Human-chimp conserved

human_chimp_heart_specific_75_hs <- human_chimp_heart_specific_75[which(human_chimp_heart_specific_75[,9] == 0), ]

human_chimp_heart_specific_75_conserved <- human_chimp_heart_specific_75[which(human_chimp_heart_specific_75[,9] > 0), ]

human_chimp_heart_specific_75_conserved <- human_chimp_heart_specific_75_conserved[which(human_chimp_heart_specific_75_conserved[,4] == human_chimp_heart_specific_75_conserved[,8]),]

# Human-chimp-rhesus 

human_rhesus_heart_specific_75 <- bedr(input = list(a = human_DMR_heart_specific_75[,1:4], b = rhesus_DMR_heart_specific_75[,1:4]), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_chimp_rhesus_heart_specific_75 <- cbind(human_chimp_heart_specific_75, human_rhesus_heart_specific_75)

# Human-chimp-rhesus-conserved

human_chimp_rhesus_heart_specific_75_hs <- human_chimp_rhesus_heart_specific_75[which(human_chimp_rhesus_heart_specific_75[,9] == 0 & human_chimp_rhesus_heart_specific_75[,18] == 0), ]

human_chimp_rhesus_heart_specific_75_conserved <- human_chimp_rhesus_heart_specific_75[which(human_chimp_rhesus_heart_specific_75[,9] > 0 & human_chimp_rhesus_heart_specific_75[,18] > 0),]

dim(human_chimp_rhesus_heart_specific_75_conserved)


```


# General function for identifying conserved versus human-specific tDMRs

```{r}

human_chimp_rhesus_hs_versus_overlap_25 <- function(human_DMR_tissue_specific, chimp_DMR_tissue_specific, rhesus_DMR_tissue_specific, put_human_specific, put_human_chimp_conserved, put_human_specific_in_hcr, put_human_chimp_rhesus_conserved){
  # Rename
  human_DMR_heart_specific_25 <- human_DMR_tissue_specific[,1:4]
  chimp_DMR_heart_specific_25 <- chimp_DMR_tissue_specific[,1:4]
  rhesus_DMR_heart_specific_25 <- rhesus_DMR_tissue_specific[,1:4]
  
  human_DMR_heart_specific_25 <- bedr.merge.region(human_DMR_heart_specific_25)
  chimp_DMR_heart_specific_25 <- bedr.merge.region(chimp_DMR_heart_specific_25)
  rhesus_DMR_heart_specific_25 <- bedr.merge.region(rhesus_DMR_heart_specific_25)
   
  # Find the human 
human_chimp_heart_specific_25 <- bedr(input = list(a = human_DMR_heart_specific_25, b = chimp_DMR_heart_specific_25), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_heart_specific_25_hs <- human_chimp_heart_specific_25[which(human_chimp_heart_specific_25[,9] == 0), ]
colnames(human_chimp_heart_specific_25_hs) <- c("chr", "start", "end")

#write.table(human_chimp_heart_specific_25_hs[,1:4], put_human_specific, quote = FALSE, row.names = FALSE, sep = "\t")

# Human-chimp conserved

human_chimp_heart_specific_25_conserved <- human_chimp_heart_specific_25[which(human_chimp_heart_specific_25[,9] > 0), ]

human_chimp_heart_specific_25_conserved <- human_chimp_heart_specific_25_conserved[which(human_chimp_heart_specific_25_conserved[,4] == human_chimp_heart_specific_25_conserved[,8]),]

#write.table(human_chimp_heart_specific_25_conserved[,1:4], put_human_chimp_conserved, quote = FALSE, row.names = FALSE, sep = "\t")



# Human-chimp-rhesus 

human_rhesus_heart_specific_25 <- bedr(input = list(a = human_DMR_heart_specific_25[,1:4], b = rhesus_DMR_heart_specific_25[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

colnames(human_chimp_heart_specific_25) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_heart_specific_25) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")


human_chimp_rhesus_heart_specific_25 <- left_join(human_chimp_heart_specific_25, human_rhesus_heart_specific_25, by= c("chr", "start")) 

# Human-chimp-rhesus conserved

human_chimp_rhesus_heart_specific_25_hs <- human_chimp_rhesus_heart_specific_25[which(human_chimp_rhesus_heart_specific_25[,9] == 0 & human_chimp_rhesus_heart_specific_25[,16] == 0), ]

#write.table(human_chimp_rhesus_heart_specific_25_hs[,1:4], put_human_specific_in_hcr, quote = FALSE, row.names = FALSE, sep = "\t")

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25[which(human_chimp_rhesus_heart_specific_25[,9] > 0 & human_chimp_rhesus_heart_specific_25[,16] > 0),]

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25_conserved[which(human_chimp_rhesus_heart_specific_25_conserved[,4] == human_chimp_rhesus_heart_specific_25_conserved[,8]),]

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25_conserved[which(human_chimp_rhesus_heart_specific_25_conserved[,11] == human_chimp_rhesus_heart_specific_25_conserved[,15]),]

#write.table(human_chimp_rhesus_heart_specific_25_conserved[,1:4], put_human_chimp_rhesus_conserved, quote = FALSE, row.names = FALSE, sep = "\t")

  row_numbers <- cbind(nrow(human_chimp_heart_specific_25_hs), nrow(human_chimp_heart_specific_25_conserved), nrow(human_chimp_rhesus_heart_specific_25_hs), nrow(human_chimp_rhesus_heart_specific_25_conserved))
  
  return(row_numbers)

}

# 50% overlap

human_chimp_rhesus_hs_versus_overlap_50 <- function(human_DMR_tissue_specific, chimp_DMR_tissue_specific, rhesus_DMR_tissue_specific, put_human_specific, put_human_chimp_conserved, put_human_specific_in_hcr, put_human_chimp_rhesus_conserved){
  # Rename
  human_DMR_heart_specific_25 <- human_DMR_tissue_specific[,1:4]
  chimp_DMR_heart_specific_25 <- chimp_DMR_tissue_specific[,1:4]
  rhesus_DMR_heart_specific_25 <- rhesus_DMR_tissue_specific[,1:4]
  
  human_DMR_heart_specific_25 <- bedr.merge.region(human_DMR_heart_specific_25)
  chimp_DMR_heart_specific_25 <- bedr.merge.region(chimp_DMR_heart_specific_25)
  rhesus_DMR_heart_specific_25 <- bedr.merge.region(rhesus_DMR_heart_specific_25)
   
  # Find the human 
human_chimp_heart_specific_25 <- bedr(input = list(a = human_DMR_heart_specific_25, b = chimp_DMR_heart_specific_25), method = "intersect",  params = "-wao -f 0.50 -F 0.50", check.chr = FALSE)

human_chimp_heart_specific_25_hs <- human_chimp_heart_specific_25[which(human_chimp_heart_specific_25[,9] == 0), ]
colnames(human_chimp_heart_specific_25_hs) <- c("chr", "start", "end")

#write.table(human_chimp_heart_specific_25_hs[,1:4], put_human_specific, quote = FALSE, row.names = FALSE, sep = "\t")

# Human-chimp conserved

human_chimp_heart_specific_25_conserved <- human_chimp_heart_specific_25[which(human_chimp_heart_specific_25[,9] > 0), ]

human_chimp_heart_specific_25_conserved <- human_chimp_heart_specific_25_conserved[which(human_chimp_heart_specific_25_conserved[,4] == human_chimp_heart_specific_25_conserved[,8]),]

#write.table(human_chimp_heart_specific_25_conserved[,1:4], put_human_chimp_conserved, quote = FALSE, row.names = FALSE, sep = "\t")



# Human-chimp-rhesus 

human_rhesus_heart_specific_25 <- bedr(input = list(a = human_DMR_heart_specific_25[,1:4], b = rhesus_DMR_heart_specific_25[,1:4]), method = "intersect",  params = "-wao -f 0.50 -F 0.50", check.chr = FALSE)

colnames(human_chimp_heart_specific_25) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_heart_specific_25) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")


human_chimp_rhesus_heart_specific_25 <- left_join(human_chimp_heart_specific_25, human_rhesus_heart_specific_25, by= c("chr", "start")) 

# Human-chimp-rhesus conserved

human_chimp_rhesus_heart_specific_25_hs <- human_chimp_rhesus_heart_specific_25[which(human_chimp_rhesus_heart_specific_25[,9] == 0 & human_chimp_rhesus_heart_specific_25[,16] == 0), ]

#write.table(human_chimp_rhesus_heart_specific_25_hs[,1:4], put_human_specific_in_hcr, quote = FALSE, row.names = FALSE, sep = "\t")

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25[which(human_chimp_rhesus_heart_specific_25[,9] > 0 & human_chimp_rhesus_heart_specific_25[,16] > 0),]

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25_conserved[which(human_chimp_rhesus_heart_specific_25_conserved[,4] == human_chimp_rhesus_heart_specific_25_conserved[,8]),]

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25_conserved[which(human_chimp_rhesus_heart_specific_25_conserved[,11] == human_chimp_rhesus_heart_specific_25_conserved[,15]),]

#write.table(human_chimp_rhesus_heart_specific_25_conserved[,1:4], put_human_chimp_rhesus_conserved, quote = FALSE, row.names = FALSE, sep = "\t")

  row_numbers <- cbind(nrow(human_chimp_heart_specific_25_hs), nrow(human_chimp_heart_specific_25_conserved), nrow(human_chimp_rhesus_heart_specific_25_hs), nrow(human_chimp_rhesus_heart_specific_25_conserved))
  
  return(row_numbers)

}


# 75% overlap

human_chimp_rhesus_hs_versus_overlap_75 <- function(human_DMR_tissue_specific, chimp_DMR_tissue_specific, rhesus_DMR_tissue_specific, put_human_specific, put_human_chimp_conserved, put_human_specific_in_hcr, put_human_chimp_rhesus_conserved){
  # Rename
  human_DMR_heart_specific_25 <- human_DMR_tissue_specific[,1:4]
  chimp_DMR_heart_specific_25 <- chimp_DMR_tissue_specific[,1:4]
  rhesus_DMR_heart_specific_25 <- rhesus_DMR_tissue_specific[,1:4]
  
  human_DMR_heart_specific_25 <- bedr.merge.region(human_DMR_heart_specific_25)
  chimp_DMR_heart_specific_25 <- bedr.merge.region(chimp_DMR_heart_specific_25)
  rhesus_DMR_heart_specific_25 <- bedr.merge.region(rhesus_DMR_heart_specific_25)
   
  # Find the human 
human_chimp_heart_specific_25 <- bedr(input = list(a = human_DMR_heart_specific_25, b = chimp_DMR_heart_specific_25), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

human_chimp_heart_specific_25_hs <- human_chimp_heart_specific_25[which(human_chimp_heart_specific_25[,9] == 0), ]
colnames(human_chimp_heart_specific_25_hs) <- c("chr", "start", "end")

#write.table(human_chimp_heart_specific_25_hs[,1:4], put_human_specific, quote = FALSE, row.names = FALSE, sep = "\t")

# Human-chimp conserved

human_chimp_heart_specific_25_conserved <- human_chimp_heart_specific_25[which(human_chimp_heart_specific_25[,9] > 0), ]

human_chimp_heart_specific_25_conserved <- human_chimp_heart_specific_25_conserved[which(human_chimp_heart_specific_25_conserved[,4] == human_chimp_heart_specific_25_conserved[,8]),]

#write.table(human_chimp_heart_specific_25_conserved[,1:4], put_human_chimp_conserved, quote = FALSE, row.names = FALSE, sep = "\t")



# Human-chimp-rhesus 

human_rhesus_heart_specific_25 <- bedr(input = list(a = human_DMR_heart_specific_25[,1:4], b = rhesus_DMR_heart_specific_25[,1:4]), method = "intersect",  params = "-wao -f 0.75 -F 0.75", check.chr = FALSE)

colnames(human_chimp_heart_specific_25) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_heart_specific_25) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")


human_chimp_rhesus_heart_specific_25 <- left_join(human_chimp_heart_specific_25, human_rhesus_heart_specific_25, by= c("chr", "start")) 

# Human-chimp-rhesus conserved

human_chimp_rhesus_heart_specific_25_hs <- human_chimp_rhesus_heart_specific_25[which(human_chimp_rhesus_heart_specific_25[,9] == 0 & human_chimp_rhesus_heart_specific_25[,16] == 0), ]

#write.table(human_chimp_rhesus_heart_specific_25_hs[,1:4], put_human_specific_in_hcr, quote = FALSE, row.names = FALSE, sep = "\t")

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25[which(human_chimp_rhesus_heart_specific_25[,9] > 0 & human_chimp_rhesus_heart_specific_25[,16] > 0),]

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25_conserved[which(human_chimp_rhesus_heart_specific_25_conserved[,4] == human_chimp_rhesus_heart_specific_25_conserved[,8]),]

human_chimp_rhesus_heart_specific_25_conserved <- human_chimp_rhesus_heart_specific_25_conserved[which(human_chimp_rhesus_heart_specific_25_conserved[,11] == human_chimp_rhesus_heart_specific_25_conserved[,15]),]

#write.table(human_chimp_rhesus_heart_specific_25_conserved[,1:4], put_human_chimp_rhesus_conserved, quote = FALSE, row.names = FALSE, sep = "\t")

  row_numbers <- cbind(nrow(human_chimp_heart_specific_25_hs), nrow(human_chimp_heart_specific_25_conserved), nrow(human_chimp_rhesus_heart_specific_25_hs), nrow(human_chimp_rhesus_heart_specific_25_conserved))
  
  return(row_numbers)

}

```


```{r}

# Heart specific

human_chimp_rhesus_hs_versus_overlap_25(human_heart_specific_25, chimp_heart_specific_25, rhesus_heart_specific_25,  "../data/overlap_reg/human_chimp_heart_specific_25_hs.bed", "../data/overlap_reg/human_chimp_heart_specific_25_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_heart_specific_25_hs.bed", "../data/overlap_reg/human_chimp_rhesus_heart_specific_25_conserved.bed")

human_chimp_rhesus_hs_versus_overlap_50(human_heart_specific_50, chimp_heart_specific_50, rhesus_heart_specific_50,  "../data/overlap_reg/human_chimp_heart_specific_50_hs.bed", "../data/overlap_reg/human_chimp_heart_specific_50_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_heart_specific_50_hs.bed", "../data/overlap_reg/human_chimp_rhesus_heart_specific_50_conserved.bed")

human_chimp_rhesus_hs_versus_overlap_75(human_heart_specific_75, chimp_heart_specific_75, rhesus_heart_specific_75,  "../data/overlap_reg/human_chimp_heart_specific_75_hs.bed", "../data/overlap_reg/human_chimp_heart_specific_75_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_heart_specific_75_hs.bed", "../data/overlap_reg/human_chimp_rhesus_heart_specific_75_conserved.bed")


# Liver specific

human_chimp_rhesus_hs_versus_overlap_25(human_liver_specific_25, chimp_liver_specific_25, rhesus_liver_specific_25,  "../data/overlap_reg/human_chimp_liver_specific_25_hs.bed", "../data/overlap_reg/human_chimp_liver_specific_25_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_liver_specific_25_hs.bed", "../data/overlap_reg/human_chimp_rhesus_liver_specific_25_conserved.bed")

human_chimp_rhesus_hs_versus_overlap_50(human_liver_specific_50, chimp_liver_specific_50, rhesus_liver_specific_50,  "../data/overlap_reg/human_chimp_liver_specific_50_hs.bed", "../data/overlap_reg/human_chimp_liver_specific_50_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_liver_specific_50_hs.bed", "../data/overlap_reg/human_chimp_rhesus_liver_specific_50_conserved.bed")

human_chimp_rhesus_hs_versus_overlap_75(human_liver_specific_75, chimp_liver_specific_75, rhesus_liver_specific_75,  "../data/overlap_reg/human_chimp_liver_specific_75_hs.bed", "../data/overlap_reg/human_chimp_liver_specific_75_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_liver_specific_75_hs.bed", "../data/overlap_reg/human_chimp_rhesus_liver_specific_75_conserved.bed")


# Lung specific

human_chimp_rhesus_hs_versus_overlap_25(human_lung_specific_25, chimp_lung_specific_25, rhesus_lung_specific_25,  "../data/overlap_reg/human_chimp_lung_specific_25_hs.bed", "../data/overlap_reg/human_chimp_lung_specific_25_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_lung_specific_25_hs.bed", "../data/overlap_reg/human_chimp_rhesus_lung_specific_25_conserved.bed")

human_chimp_rhesus_hs_versus_overlap_50(human_lung_specific_50, chimp_lung_specific_50, rhesus_lung_specific_50,  "../data/overlap_reg/human_chimp_lung_specific_50_hs.bed", "../data/overlap_reg/human_chimp_lung_specific_50_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_lung_specific_50_hs.bed", "../data/overlap_reg/human_chimp_rhesus_lung_specific_50_conserved.bed")

human_chimp_rhesus_hs_versus_overlap_75(human_lung_specific_75, chimp_lung_specific_75, rhesus_lung_specific_75,  "../data/overlap_reg/human_chimp_lung_specific_75_hs.bed", "../data/overlap_reg/human_chimp_lung_specific_75_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_lung_specific_75_hs.bed", "../data/overlap_reg/human_chimp_rhesus_lung_specific_75_conserved.bed")



# Kidney specific

human_chimp_rhesus_hs_versus_overlap_25(human_kidney_specific_25, chimp_kidney_specific_25, rhesus_kidney_specific_25,  "../data/overlap_reg/human_chimp_kidney_specific_25_hs.bed", "../data/overlap_reg/human_chimp_kidney_specific_25_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_kidney_specific_25_hs.bed", "../data/overlap_reg/human_chimp_rhesus_kidney_specific_25_conserved.bed")

human_chimp_rhesus_hs_versus_overlap_50(human_kidney_specific_50, chimp_kidney_specific_50, rhesus_kidney_specific_50,  "../data/overlap_reg/human_chimp_kidney_specific_50_hs.bed", "../data/overlap_reg/human_chimp_kidney_specific_50_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_kidney_specific_50_hs.bed", "../data/overlap_reg/human_chimp_rhesus_kidney_specific_50_conserved.bed")

human_chimp_rhesus_hs_versus_overlap_75(human_kidney_specific_75, chimp_kidney_specific_75, rhesus_kidney_specific_75,  "../data/overlap_reg/human_chimp_kidney_specific_75_hs.bed", "../data/overlap_reg/human_chimp_kidney_specific_75_conserved.bed", "../data/overlap_reg/human_chimp_rhesus_kidney_specific_75_hs.bed", "../data/overlap_reg/human_chimp_rhesus_kidney_specific_75_conserved.bed")

```

# Make plot

```{r}
tissue_conserved_25_overlap <- function(DMR1_human, DMR1_chimp, DMR1_rhesus){

# Human-chimp/human-rhesus

human_chimp_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_chimp), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_DMR <- human_chimp_DMR[which(human_chimp_DMR[,6] != -1), ]

human_rhesus_DMR <- bedr(input = list(a = DMR1_human, b = DMR1_rhesus), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_rhesus_DMR <- human_rhesus_DMR[which(human_rhesus_DMR[,6] != -1), ]

chimp_rhesus_DMR <- bedr(input = list(a = DMR1_chimp, b = DMR1_rhesus), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

chimp_rhesus_DMR <- chimp_rhesus_DMR[which(chimp_rhesus_DMR[,6] != -1), ]

colnames(human_chimp_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(human_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

colnames(chimp_rhesus_DMR) <- c("chr", "start", "end", "direction", "chr.b", "start.b", "end.b", "direction.b", "overlap")

human_chimp_DMR <- bedr.merge.region(human_chimp_DMR)
human_rhesus_DMR <- bedr.merge.region(human_rhesus_DMR)
chimp_rhesus_DMR <- bedr.merge.region(chimp_rhesus_DMR)

# Human-chimp-rhesus

human_chimp_rhesus1_DMR <- bedr(input = list(a = human_chimp_DMR, b = human_rhesus_DMR), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_rhesus1a_DMR <- human_chimp_rhesus1_DMR[which(human_chimp_rhesus1_DMR[,6] != -1), ]

human_chimp_rhesus2_DMR <- bedr(input = list(a = human_chimp_rhesus1a_DMR[,1:4], b = chimp_rhesus_DMR), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_rhesus2a_DMR <- human_chimp_rhesus2_DMR[which(human_chimp_rhesus2_DMR[,6] != -1), ]

nrow(human_chimp_rhesus2a_DMR)

# human_chimp_rhesus2a_DMR gives the number of H/C/R conserved tDMRs

# Conserved in only 2 species

human_chimp_only <- bedr(input = list(a = human_chimp_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_chimp_only <- human_chimp_only[which(human_chimp_only[,6] == -1), ]

nrow(human_chimp_only)

human_rhesus_only <- bedr(input = list(a = human_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

human_rhesus_only <- human_rhesus_only[which(human_rhesus_only[,6] == -1), ]

nrow(human_rhesus_only)

chimp_rhesus_only <- bedr(input = list(a = chimp_rhesus_DMR, b = human_chimp_rhesus2a_DMR[,1:4]), method = "intersect",  params = "-wao -f 0.25 -F 0.25", check.chr = FALSE)

chimp_rhesus_only <- chimp_rhesus_only[which(chimp_rhesus_only[,6] == -1), ]

nrow(chimp_rhesus_only)

# Species-specific

human_specific <- nrow(DMR1_human) - nrow(human_chimp_only) - nrow(human_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

chimp_specific <- nrow(DMR1_chimp) - nrow(human_chimp_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

rhesus_specific <- nrow(DMR1_rhesus) - nrow(human_rhesus_only) - nrow(chimp_rhesus_only) - nrow(human_chimp_rhesus2a_DMR)

combine <- cbind(human_specific, chimp_specific, rhesus_specific, nrow(human_chimp_only), nrow(human_rhesus_only), nrow(chimp_rhesus_only), nrow(human_chimp_rhesus2a_DMR))

colnames(combine) <- c("human_specific", "chimp_specific", "rhesus_specific", "hc", "hr", "cr", "hcr_conserved")

return(combine)
}

tissue_conserved_25_overlap(human_heart_specific_25[,1:4], chimp_heart_specific_25[,1:4], rhesus_heart_specific_25[,1:4])

#  human_specific chimp_specific rhesus_specific  hc  hr cr hcr_conserved
#[1,]           2413           1212            1354   389 101 76            66


human_heart_specific_25_hypo <- human_heart_specific_25[which(human_heart_specific_25[,4] == "hypo"),]

chimp_heart_specific_25_hypo <- chimp_heart_specific_25[which(chimp_heart_specific_25[,4] == "hypo"),]

rhesus_heart_specific_25_hypo <- rhesus_heart_specific_25[which(rhesus_heart_specific_25[,4] == "hypo"),]


tissue_conserved_25_overlap(human_heart_specific_25_hypo[,1:4], chimp_heart_specific_25_hypo[,1:4], rhesus_heart_specific_25_hypo[,1:4])

# human_specific chimp_specific rhesus_specific  hc hr cr hcr_conserved
#[1,]           2094           1014            1175   351 92 66            62

dev.off()
draw.triple.venn(nrow(human_heart_specific_25_hypo), nrow(chimp_heart_specific_25_hypo), nrow(rhesus_heart_specific_25_hypo), 351+62, 66+62, 92+62, 62,  main= "Heart versus kidney (hypomethylated)",  category = c("Human", "Chimp", "Rhesus macaque"), height=3000, width=3000, cex=2 , fill = pal[1:3], lty=1, cat.cex = 2, main.cex = 2)


human_heart_specific_25_hypo <- human_heart_specific_25[which(human_heart_specific_25[,4] == "hyper"),]

chimp_heart_specific_25_hypo <- chimp_heart_specific_25[which(chimp_heart_specific_25[,4] == "hyper"),]

rhesus_heart_specific_25_hypo <- rhesus_heart_specific_25[which(rhesus_heart_specific_25[,4] == "hyper"),]


tissue_conserved_25_overlap(human_heart_specific_25_hypo[,1:4], chimp_heart_specific_25_hypo[,1:4], rhesus_heart_specific_25_hypo[,1:4])



#     human_specific chimp_specific rhesus_specific hc hr cr hcr_conserved
#[1,]            319            198             179 38  9 10             4

dev.off()
draw.triple.venn(nrow(human_heart_specific_25_hypo), nrow(chimp_heart_specific_25_hypo), nrow(rhesus_heart_specific_25_hypo), 38+4, 10+4, 9+4, 4,  main= "Heart versus kidney (hypomethylated)",  category = c("Human", "Chimp", "Rhesus macaque"), height=3000, width=3000, cex=2 , fill = pal[1:3], lty=1, cat.cex = 2, main.cex = 2)



tissue_conserved_25_overlap(human_liver_specific_25[,1:4], chimp_liver_specific_25[,1:4], rhesus_liver_specific_25[,1:4])

#     human_specific chimp_specific rhesus_specific  hc  hr  cr hcr_conserved
#[1,]           1571           4207            9754 849 395 843           478

tissue_conserved_25_overlap(human_lung_specific_25[,1:4], chimp_lung_specific_25[,1:4], rhesus_lung_specific_25[,1:4])

#     human_specific chimp_specific rhesus_specific hc hr cr hcr_conserved
#[1,]            415            382             488 46 13 20             5

tissue_conserved_25_overlap(human_kidney_specific_25[,1:4], chimp_kidney_specific_25[,1:4], rhesus_kidney_specific_25[,1:4])
```






# Terminal commands

Left ventricle (E095), liver (E066), and lung (E096) from http://egg2.wustl.edu/roadmap/data/byFileType/peaks/consolidated/broadPeak/ucsc_compatible/
Kidney from http://egg2.wustl.edu/roadmap/data/byFileType/peaks/unconsolidated/broadPeak/ucsc_compatible/ 

## Heart specific 

bedtools intersect -a human_chimp_heart_specific_25_hs.bed -b E095-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_heart_specific_25_hs_test.bed

bedtools intersect -a human_chimp_heart_specific_25_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_heart_specific_25_conserved_test.bed

## Heart specific in hearts

bedtools intersect -a human_chimp_rhesus_lung_specific_25_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_heart_specific_25_conserved_H3K27_HEART.bed

## Heart specific in kidneys

bedtools intersect -a human_chimp_rhesus_lung_specific_25_conserved.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.25  > human_chimp_heart_specific_25_conserved_H3K27_KIDNEY.bed

## Heart specific in livers

bedtools intersect -a human_chimp_rhesus_lung_specific_25_conserved.bed -b E066-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_heart_specific_25_conserved_H3K27_LIVER.bed

## Heart specific in lungs

bedtools intersect -a human_chimp_rhesus_lung_specific_25_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_heart_specific_25_conserved_H3K27_LUNGS.bed


## Heart specific in hearts

bedtools intersect -a human_chimp_rhesus_heart_specific_25_conserved.bed -b ENCSR501FWC_rep2_1_pe_bwa_biorep_filtered_hotspots.bed  -wao -f 0.25  > human_chimp_heart_specific_25_conserved_DHS_HEART.bed

## Heart specific in kidneys

bedtools intersect -a human_chimp_rhesus_heart_specific_25_conserved.bed -b ENCSR422PVL_rep1_2_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.25  > human_chimp_heart_specific_25_conserved_DHS_KIDNEY.bed

## Heart specific in livers

bedtools intersect -a human_chimp_rhesus_heart_specific_25_conserved.bed -b ENCSR562FNN_rep1_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.25  > human_chimp_heart_specific_25_conserved_DHS_LIVER.bed

## Heart specific in lungs

bedtools intersect -a human_chimp_rhesus_heart_specific_25_conserved.bed -b ENCSR541AVF_rep1_3_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.25  > human_chimp_heart_specific_25_conserved_DHS_LUNGS.bed


```{r}
# Read in data- human specific 
human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_DHS_HEART.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)
#0.6388889


hyper_only_conserved <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)
nrow(hyper_only_conserved_overlap)


human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_DHS_KIDNEY.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)

hyper_only_conserved <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)
nrow(hyper_only_conserved_overlap)


# 0.115

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_DHS_LIVER.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)
# 0.115 8/69

 hyper_only_conserved <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)
nrow(hyper_only_conserved_overlap)

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_DHS_LUNGS.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)
#0.1014493 #7

hyper_only_conserved <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)
nrow(hyper_only_conserved_overlap)

```


```{r}
# Read in data- human specific 
human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_H3K27_HEART.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)
#0.8550725 59/69

hyper_only_conserved <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)
nrow(hyper_only_conserved_overlap)


human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_H3K27_KIDNEY.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)

hyper_only_conserved <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)
nrow(hyper_only_conserved_overlap)


# 0.71  49

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_H3K27_LIVER.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)
# 0.5652174 39

hyper_only_conserved <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)
nrow(hyper_only_conserved_overlap)


human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_H3K27_LUNGS.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)
#0.7246377 #50

hyper_only_conserved <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)
nrow(hyper_only_conserved_overlap)

prop.test(x = c(8,48), n = c(65,65))

```




## 25% overlap
bedtools intersect -a human_chimp_heart_specific_25_hs.bed -b E095-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_heart_specific_25_hs_test.bed

bedtools intersect -a human_chimp_heart_specific_25_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_heart_specific_25_conserved_test.bed

bedtools intersect -a human_chimp_heart_specific_25_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_heart_specific_25_hs_liver_test.bed

bedtools intersect -a human_chimp_heart_specific_25_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_heart_specific_25_conserved_liver_test.bed

bedtools intersect -a human_chimp_rhesus_heart_specific_25_hs.bed -b E095-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_rhesus_heart_specific_25_hs_test.bed

bedtools intersect -a human_chimp_rhesus_heart_specific_25_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_rhesus_heart_specific_25_conserved_test.bed

## 50% overlap

bedtools intersect -a human_chimp_heart_specific_50_hs.bed -b E095-H3K27ac.broadPeak -wao -f 0.50 > human_chimp_heart_specific_50_hs_test.bed
bedtools intersect -a human_chimp_heart_specific_50_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.50  > human_chimp_heart_specific_50_conserved_test.bed
bedtools intersect -a human_chimp_rhesus_heart_specific_50_hs.bed -b E095-H3K27ac.broadPeak -wao -f 0.50 > human_chimp_rhesus_heart_specific_50_hs_test.bed
bedtools intersect -a human_chimp_rhesus_heart_specific_50_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.50  > human_chimp_rhesus_heart_specific_50_conserved_test.bed

## 75% overlap

bedtools intersect -a human_chimp_heart_specific_75_hs.bed -b E095-H3K27ac.broadPeak -wao -f 0.75 > human_chimp_heart_specific_75_hs_test.bed
bedtools intersect -a human_chimp_heart_specific_75_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.75  > human_chimp_heart_specific_75_conserved_test.bed
bedtools intersect -a human_chimp_rhesus_heart_specific_75_hs.bed -b E095-H3K27ac.broadPeak -wao -f 0.75 > human_chimp_rhesus_heart_specific_75_hs_test.bed
bedtools intersect -a human_chimp_rhesus_heart_specific_75_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.75  > human_chimp_rhesus_heart_specific_75_conserved_test.bed



## Liver specific 

## 25% overlap
bedtools intersect -a human_chimp_liver_specific_25_hs.bed -b E066-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_liver_specific_25_hs_test.bed
bedtools intersect -a human_chimp_liver_specific_25_conserved.bed -b E066-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_liver_specific_25_conserved_test.bed

bedtools intersect -a human_chimp_liver_specific_25_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_liver_specific_25_hs_lung_test.bed
bedtools intersect -a human_chimp_liver_specific_25_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_liver_specific_25_conserved_lung_test.bed

bedtools intersect -a human_chimp_rhesus_liver_specific_25_hs.bed -b E066-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_rhesus_liver_specific_25_hs_test.bed
bedtools intersect -a human_chimp_rhesus_liver_specific_25_conserved.bed -b E066-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_rhesus_liver_specific_25_conserved_test.bed

## 50% overlap

bedtools intersect -a human_chimp_liver_specific_50_hs.bed -b E066-H3K27ac.broadPeak -wao -f 0.50 > human_chimp_liver_specific_50_hs_test.bed
bedtools intersect -a human_chimp_liver_specific_50_conserved.bed -b E066-H3K27ac.broadPeak -wao -f 0.50  > human_chimp_liver_specific_50_conserved_test.bed
bedtools intersect -a human_chimp_rhesus_liver_specific_50_hs.bed -b E066-H3K27ac.broadPeak -wao -f 0.50 > human_chimp_rhesus_liver_specific_50_hs_test.bed
bedtools intersect -a human_chimp_rhesus_liver_specific_50_conserved.bed -b E066-H3K27ac.broadPeak -wao -f 0.50  > human_chimp_rhesus_liver_specific_50_conserved_test.bed

## 75% overlap

bedtools intersect -a human_chimp_liver_specific_75_hs.bed -b E066-H3K27ac.broadPeak -wao -f 0.75 > human_chimp_liver_specific_75_hs_test.bed
bedtools intersect -a human_chimp_liver_specific_75_conserved.bed -b E066-H3K27ac.broadPeak -wao -f 0.75  > human_chimp_liver_specific_75_conserved_test.bed
bedtools intersect -a human_chimp_rhesus_liver_specific_75_hs.bed -b E066-H3K27ac.broadPeak -wao -f 0.75 > human_chimp_rhesus_liver_specific_75_hs_test.bed
bedtools intersect -a human_chimp_rhesus_liver_specific_75_conserved.bed -b E066-H3K27ac.broadPeak -wao -f 0.75  > human_chimp_rhesus_liver_specific_75_conserved_test.bed

## Lung specific 

## 25% overlap
bedtools intersect -a human_chimp_lung_specific_25_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_lung_specific_25_hs_test.bed
bedtools intersect -a human_chimp_lung_specific_25_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_lung_specific_25_conserved_test.bed

bedtools intersect -a human_chimp_lung_specific_25_hs.bed -b E095-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_lung_specific_25_hs_heart_test.bed
bedtools intersect -a human_chimp_lung_specific_25_conserved.bed -b E095-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_lung_specific_25_conserved_heart_test.bed

bedtools intersect -a human_chimp_rhesus_lung_specific_25_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_rhesus_lung_specific_25_hs_test.bed
bedtools intersect -a human_chimp_rhesus_lung_specific_25_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_rhesus_lung_specific_25_conserved_test.bed

## 50% overlap

bedtools intersect -a human_chimp_lung_specific_50_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.50 > human_chimp_lung_specific_50_hs_test.bed
bedtools intersect -a human_chimp_lung_specific_50_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.50  > human_chimp_lung_specific_50_conserved_test.bed
bedtools intersect -a human_chimp_rhesus_lung_specific_50_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.50 > human_chimp_rhesus_lung_specific_50_hs_test.bed
bedtools intersect -a human_chimp_rhesus_lung_specific_50_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.50  > human_chimp_rhesus_lung_specific_50_conserved_test.bed

## 75% overlap

bedtools intersect -a human_chimp_lung_specific_75_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.75 > human_chimp_lung_specific_75_hs_test.bed
bedtools intersect -a human_chimp_lung_specific_75_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.75  > human_chimp_lung_specific_75_conserved_test.bed
bedtools intersect -a human_chimp_rhesus_lung_specific_75_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.75 > human_chimp_rhesus_lung_specific_75_hs_test.bed
bedtools intersect -a human_chimp_rhesus_lung_specific_75_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.75  > human_chimp_rhesus_lung_specific_75_conserved_test.bed



## Kidney specific (BI.Adult_Kidney.H3K27ac.27.broadPeak)

## 25% overlap
bedtools intersect -a human_chimp_kidney_specific_25_hs.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.25 > human_chimp_kidney_specific_25_hs_test.bed
bedtools intersect -a human_chimp_kidney_specific_25_conserved.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.25  > human_chimp_kidney_specific_25_conserved_test.bed

bedtools intersect -a human_chimp_kidney_specific_25_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_kidney_specific_25_hs_lung_test.bed
bedtools intersect -a human_chimp_kidney_specific_25_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_kidney_specific_25_conserved_lung_test.bed

bedtools intersect -a human_chimp_rhesus_kidney_specific_25_hs.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.25 > human_chimp_rhesus_kidney_specific_25_hs_test.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_25_conserved.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.25  > human_chimp_rhesus_kidney_specific_25_conserved_test.bed

## 50% overlap

bedtools intersect -a human_chimp_kidney_specific_50_hs.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.50 > human_chimp_kidney_specific_50_hs_test.bed
bedtools intersect -a human_chimp_kidney_specific_50_conserved.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.50  > human_chimp_kidney_specific_50_conserved_test.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_50_hs.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.50 > human_chimp_rhesus_kidney_specific_50_hs_test.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_50_conserved.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.50  > human_chimp_rhesus_kidney_specific_50_conserved_test.bed

## 75% overlap

bedtools intersect -a human_chimp_kidney_specific_75_hs.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.75 > human_chimp_kidney_specific_75_hs_test.bed
bedtools intersect -a human_chimp_kidney_specific_75_conserved.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.75  > human_chimp_kidney_specific_75_conserved_test.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_75_hs.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.75 > human_chimp_rhesus_kidney_specific_75_hs_test.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_75_conserved.bed -b BI.Adult_Kidney.H3K27ac.27.broadPeak -wao -f 0.75  > human_chimp_rhesus_kidney_specific_75_conserved_test.bed


## Kidney specific (BI.Adult_Kidney.H3K27ac.153.broadPeak)

## 25% overlap
bedtools intersect -a human_chimp_kidney_specific_25_hs.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.25 > human_chimp_kidney_specific_25_hs_test2.bed
bedtools intersect -a human_chimp_kidney_specific_25_conserved.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.25  > human_chimp_kidney_specific_25_conserved_test2.bed
bedtools intersect -a human_chimp_kidney_specific_25_hs.bed -b E096-H3K27ac.broadPeak -wao -f 0.25 > human_chimp_kidney_specific_25_hs_lung_test2.bed
bedtools intersect -a human_chimp_kidney_specific_25_conserved.bed -b E096-H3K27ac.broadPeak -wao -f 0.25  > human_chimp_kidney_specific_25_conserved_lung_test2.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_25_hs.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.25 > human_chimp_rhesus_kidney_specific_25_hs_test2.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_25_conserved.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.25  > human_chimp_rhesus_kidney_specific_25_conserved_test2.bed

## 50% overlap

bedtools intersect -a human_chimp_kidney_specific_50_hs.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.50 > human_chimp_kidney_specific_50_hs_test2.bed
bedtools intersect -a human_chimp_kidney_specific_50_conserved.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.50  > human_chimp_kidney_specific_50_conserved_test2.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_50_hs.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.50 > human_chimp_rhesus_kidney_specific_50_hs_test2.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_50_conserved.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.50  > human_chimp_rhesus_kidney_specific_50_conserved_test2.bed

## 75% overlap

bedtools intersect -a human_chimp_kidney_specific_75_hs.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.75 > human_chimp_kidney_specific_75_hs_test2.bed
bedtools intersect -a human_chimp_kidney_specific_75_conserved.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.75  > human_chimp_kidney_specific_75_conserved_test2.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_75_hs.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.75 > human_chimp_rhesus_kidney_specific_75_hs_test2.bed
bedtools intersect -a human_chimp_rhesus_kidney_specific_75_conserved.bed -b BI.Adult_Kidney.H3K27ac.153.broadPeak -wao -f 0.75  > human_chimp_rhesus_kidney_specific_75_conserved_test2.bed


## Conserved kidney

## 25% overlap
bedtools intersect -a human_chimp_kidney_specific_25_hs.bed -b combined_kidney.bed -wao -f 0.25 > human_chimp_kidney_specific_25_hs_test3.bed
bedtools intersect -a human_chimp_kidney_specific_25_conserved.bed -b combined_kidney.bed -wao -f 0.25  > human_chimp_kidney_specific_25_conserved_test3.bed
bedtools intersect -a human_chimp_kidney_specific_50_hs.bed -b combined_kidney.bed -wao -f 0.50 > human_chimp_kidney_specific_50_hs_test3.bed
bedtools intersect -a human_chimp_kidney_specific_50_conserved.bed -b combined_kidney.bed -wao -f 0.50  > human_chimp_kidney_specific_50_conserved_test3.bed
bedtools intersect -a human_chimp_kidney_specific_75_hs.bed -b combined_kidney.bed -wao -f 0.75 > human_chimp_kidney_specific_75_hs_test3.bed
bedtools intersect -a human_chimp_kidney_specific_75_conserved.bed -b combined_kidney.bed -wao -f 0.75  > human_chimp_kidney_specific_75_conserved_test3.bed



## 25% overlap
bedtools intersect -a human_chimp_heart_specific_25_hs.bed -b ENCSR501FWC_rep2_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.25 > human_chimp_heart_specific_25_hs_test.bed
bedtools intersect -a human_chimp_heart_specific_25_conserved.bed -b ENCSR501FWC_rep2_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.25  > human_chimp_heart_specific_25_conserved_test.bed
bedtools intersect -a human_chimp_heart_specific_50_hs.bed -b ENCSR501FWC_rep2_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.50 > human_chimp_heart_specific_50_hs_test.bed
bedtools intersect -a human_chimp_heart_specific_50_conserved.bed -b ENCSR501FWC_rep2_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.50  > human_chimp_heart_specific_50_conserved_test.bed
bedtools intersect -a human_chimp_heart_specific_75_hs.bed -b ENCSR501FWC_rep2_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.75 > human_chimp_heart_specific_75_hs_test.bed
bedtools intersect -a human_chimp_heart_specific_75_conserved.bed -b ENCSR501FWC_rep2_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.75  > human_chimp_heart_specific_75_conserved_test.bed


# Liver
bedtools intersect -a human_chimp_liver_specific_25_hs.bed -b ENCSR562FNN_rep1_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.25 > human_chimp_liver_specific_25_hs_test.bed
bedtools intersect -a human_chimp_liver_specific_25_conserved.bed -b ENCSR562FNN_rep1_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.25  > human_chimp_liver_specific_25_conserved_test.bed
bedtools intersect -a human_chimp_liver_specific_50_hs.bed -b ENCSR562FNN_rep1_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.50 > human_chimp_liver_specific_50_hs_test.bed
bedtools intersect -a human_chimp_liver_specific_50_conserved.bed -b ENCSR562FNN_rep1_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.50  > human_chimp_liver_specific_50_conserved_test.bed
bedtools intersect -a human_chimp_liver_specific_75_hs.bed -b ENCSR562FNN_rep1_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.75 > human_chimp_liver_specific_75_hs_test.bed
bedtools intersect -a human_chimp_liver_specific_75_conserved.bed -b ENCSR562FNN_rep1_1_pe_bwa_biorep_filtered_hotspots.bed -wao -f 0.75  > human_chimp_liver_specific_75_conserved_test.bed


ENCSR541AVF_rep1_3_se_bwa_biorep_filtered_hotspots.bed

## Lung
bedtools intersect -a human_chimp_lung_specific_25_hs.bed -b ENCSR541AVF_rep1_3_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.25 > human_chimp_lung_specific_25_hs_test.bed
bedtools intersect -a human_chimp_lung_specific_25_conserved.bed -b ENCSR541AVF_rep1_3_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.25  > human_chimp_lung_specific_25_conserved_test.bed
bedtools intersect -a human_chimp_lung_specific_50_hs.bed -b ENCSR541AVF_rep1_3_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.50 > human_chimp_lung_specific_50_hs_test.bed
bedtools intersect -a human_chimp_lung_specific_50_conserved.bed -b ENCSR541AVF_rep1_3_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.50  > human_chimp_lung_specific_50_conserved_test.bed
bedtools intersect -a human_chimp_lung_specific_75_hs.bed -b ENCSR541AVF_rep1_3_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.75 > human_chimp_lung_specific_75_hs_test.bed
bedtools intersect -a human_chimp_lung_specific_75_conserved.bed -b ENCSR541AVF_rep1_3_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.75  > human_chimp_lung_specific_75_conserved_test.bed

ENCSR422PVL_rep1_2_se_bwa_biorep_filtered_hotspots.bed

bedtools intersect -a human_chimp_kidney_specific_25_hs.bed -b ENCSR422PVL_rep1_2_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.25 > human_chimp_kidney_specific_25_hs_test2.bed
bedtools intersect -a human_chimp_kidney_specific_25_conserved.bed -b ENCSR422PVL_rep1_2_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.25  > human_chimp_kidney_specific_25_conserved_test2.bed
bedtools intersect -a human_chimp_kidney_specific_50_hs.bed -b ENCSR422PVL_rep1_2_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.50 > human_chimp_kidney_specific_50_hs_test2.bed
bedtools intersect -a human_chimp_kidney_specific_50_conserved.bed -b ENCSR422PVL_rep1_2_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.50  > human_chimp_kidney_specific_50_conserved_test2.bed
bedtools intersect -a human_chimp_kidney_specific_75_hs.bed -b ENCSR422PVL_rep1_2_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.75 > human_chimp_kidney_specific_75_hs_test2.bed
bedtools intersect -a human_chimp_kidney_specific_75_conserved.bed -b ENCSR422PVL_rep1_2_se_bwa_biorep_filtered_hotspots.bed -wao -f 0.75  > human_chimp_kidney_specific_75_conserved_test2.bed


# Pull the human-chimp data back in from bedtools

## Perform initial analysis
```{r}
# Read in data- human specific 
human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_hs_test.bed", header = FALSE)
dim(human_chimp_heart_specific_25_hs_test)

# Eliminate duplicates

dedup_human_chimp_heart_specific_25_hs_test <- human_chimp_heart_specific_25_hs_test[!duplicated(human_chimp_heart_specific_25_hs_test[,1:2]),]
dim(dedup_human_chimp_heart_specific_25_hs_test)

dedup_overlap_human_chimp_heart_specific_25_hs_test <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

# Look at fraction overlapping H3K27ac
location <- dedup_human_chimp_heart_specific_25_hs_test[which(dedup_human_chimp_heart_specific_25_hs_test$V6 != -1),]

nrow(location)/nrow(human_chimp_heart_specific_25_hs_test)




# Read in data- human and chimp conserved

human_chimp_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_test.bed", header = FALSE)

dedup_overlap_human_chimp_heart_specific_25_conserved_test <- human_chimp_heart_specific_25_conserved_test[which(human_chimp_heart_specific_25_conserved_test$V6 != -1),]

nrow(dedup_overlap_human_chimp_heart_specific_25_conserved_test)/nrow(human_chimp_heart_specific_25_conserved_test)

# Run a difference in proportions test

res <- prop.test(x = c(1918, 373), n = c(2473, 441))
res
```

## Separate into hyper- and hypo- methylated regions
```{r}
# What if we look at just the hypermethylated regions

# Human Specific
hyper_only_hs <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hyper"),]

hyper_only_hs_overlap <- hyper_only_hs[which(hyper_only_hs$V6 != -1),]

nrow(hyper_only_hs_overlap)/nrow(hyper_only_hs)

# Conserved
hyper_only_conserved <- human_chimp_heart_specific_25_conserved_test[which(human_chimp_heart_specific_25_conserved_test[,4] == "hyper"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)



# What if we look at just the hypomethylated regions (hypomethylated regions, aka regions of less methylation, are more likely to be associated with an activating mark like H3K27ac)

# Human Specific
hyper_only_hs <- human_chimp_heart_specific_25_hs_test[which(human_chimp_heart_specific_25_hs_test[,4] == "hypo"),]

hyper_only_hs_overlap <- hyper_only_hs[which(hyper_only_hs$V6 != -1),]

nrow(hyper_only_hs_overlap)/nrow(hyper_only_hs)

# Conserved
hyper_only_conserved <- human_chimp_heart_specific_25_conserved_test[which(human_chimp_heart_specific_25_conserved_test[,4] == "hypo"),]

hyper_only_conserved_overlap <- hyper_only_conserved[which(hyper_only_conserved$V6 != -1),]

nrow(hyper_only_conserved_overlap)/nrow(hyper_only_conserved)


# Run the t test

res <- prop.test(x = c(nrow(hyper_only_hs_overlap), nrow(hyper_only_conserved_overlap)), n = c(nrow(hyper_only_hs), nrow(hyper_only_conserved)))
res
```

# Make a function to pull overlap


```{r}
# Make a function that exports fraction overlap and p values of the differences for all data (row 1), hypomethylated data (row 2; what we are arguably most interested in), and hypermethylated data (row 3)

diff_prop_hs_versus_conserved <- function(filename_human_specific, filename_conserved){

######################################### FIRST, RUN THE FUNCTION ON ALL DATA #####################
  # Start with the human specific data
  
  filename_human_specific_overlap <- filename_human_specific[which(filename_human_specific$V6 != -1),]

  # Look at fraction overlapping H3K27ac
  fraction_hs_overlap <- nrow(filename_human_specific_overlap)/nrow(filename_human_specific)


  
  
  # Then, the conserved data
  filename_conserved_overlap <- filename_conserved[which(filename_conserved$V6 != -1),]
  fraction_conserved_overlap <- nrow(filename_conserved_overlap)/nrow(filename_conserved)

  # Run a difference in proportions test

  res <- prop.test(x = c(nrow(filename_human_specific_overlap), nrow(filename_conserved_overlap)), n = c(nrow(filename_human_specific), nrow(filename_conserved)))

  import_values_1 <- cbind(fraction_hs_overlap, fraction_conserved_overlap, res$p.value)
  
######################################### NEXT, RUN THE FUNCTION ON HYPOMETHYLATED DATA #####################
  
  # Human Specific
  hypo_only_hs <- filename_human_specific[which(filename_human_specific[,4] == "hypo"),]

  hypo_only_hs_overlap <- hypo_only_hs[which(hypo_only_hs$V6 != -1),]

  fraction_hypo_hs_overlap <- nrow(hypo_only_hs_overlap)/nrow(hypo_only_hs)

  # Conserved
  hypo_only_conserved <- filename_conserved[which(filename_conserved[,4] == "hypo"),]

  hypo_only_conserved_overlap <- hypo_only_conserved[which(hypo_only_conserved$V6 != -1),]

  fraction_hypo_conserved_overlap <- nrow(hypo_only_conserved_overlap)/nrow(hypo_only_conserved)

  # Run a difference in proportions test

  res <- prop.test(x = c(nrow(hypo_only_hs_overlap), nrow(hypo_only_conserved_overlap)), n = c(nrow(hypo_only_hs), nrow(hypo_only_conserved)))
  
  import_values_2 <- cbind(fraction_hypo_hs_overlap, fraction_hypo_conserved_overlap, res$p.value)
  
  
  ######################################### NEXT, RUN THE FUNCTION ON HYPERMETHYLATED DATA #####################
  
  # Human Specific
  hypo_only_hs <- filename_human_specific[which(filename_human_specific[,4] == "hyper"),]

  hypo_only_hs_overlap <- hypo_only_hs[which(hypo_only_hs$V6 != -1),]

  fraction_hypo_hs_overlap <- nrow(hypo_only_hs_overlap)/nrow(hypo_only_hs)

  # Conserved
  hypo_only_conserved <- filename_conserved[which(filename_conserved[,4] == "hyper"),]

  hypo_only_conserved_overlap <- hypo_only_conserved[which(hypo_only_conserved$V6 != -1),]

  fraction_hypo_conserved_overlap <- nrow(hypo_only_conserved_overlap)/nrow(hypo_only_conserved)

  # Run a difference in proportions test

  res <- prop.test(x = c(nrow(hypo_only_hs_overlap), nrow(hypo_only_conserved_overlap)), n = c(nrow(hypo_only_hs), nrow(hypo_only_conserved)))
  
  import_values_3 <- cbind(fraction_hypo_hs_overlap, fraction_hypo_conserved_overlap, res$p.value)
  
  import_values <- rbind(import_values_1, import_values_2, import_values_3)
  
  
  
  
  return(import_values)

}


#diff_prop_hs_versus_conserved(human_chimp_heart_specific_25_hs_test, human_chimp_heart_specific_25_conserved_test)

# Run with liver to compare

#human_chimp_heart_specific_25_hs_test_liver <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_hs_liver_test.bed", header = FALSE)
#human_chimp_heart_specific_25_conserved_test_liver <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_liver_test.bed", header = FALSE)

#diff_prop_hs_versus_conserved(human_chimp_heart_specific_25_hs_test_liver, human_chimp_heart_specific_25_conserved_test_liver)

```

# Heart specific

```{r}
# Heart specific 25%- human and chimp

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_hs_test.bed", header = FALSE)

human_chimp_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_25_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_25_hs_test, human_chimp_heart_specific_25_conserved_test)

# Heart specific 25%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_heart_specific_25_hs_test.bed", header = FALSE)
human_chimp_rhesus_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_heart_specific_25_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_25_hs_test, human_chimp_rhesus_heart_specific_25_conserved_test)

# Heart specific 50%- human and chimp

human_chimp_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_50_hs_test.bed", header = FALSE)
human_chimp_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_50_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_50_hs_test, human_chimp_heart_specific_50_conserved_test)

# Heart specific 50%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_heart_specific_50_hs_test.bed", header = FALSE)
human_chimp_rhesus_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_heart_specific_50_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_50_hs_test, human_chimp_rhesus_heart_specific_50_conserved_test)



# Heart specific 75%- human and chimp

human_chimp_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_75_hs_test.bed", header = FALSE)
human_chimp_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_heart_specific_75_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_75_hs_test, human_chimp_heart_specific_75_conserved_test)

# Heart specific 75%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_heart_specific_75_hs_test.bed", header = FALSE)
human_chimp_rhesus_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_heart_specific_75_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_75_hs_test, human_chimp_rhesus_heart_specific_75_conserved_test)


```


# Liver specific

Row 2 is the hypomethylated region. 

```{r}
# Liver specific 25%- human and chimp

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_liver_specific_25_hs_test.bed", header = FALSE)

human_chimp_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_liver_specific_25_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_25_hs_test, human_chimp_heart_specific_25_conserved_test)

# liver specific 25%- human, chimp, and rhesus

#human_chimp_rhesus_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_liver_specific_25_hs_test.bed", header = FALSE)
#human_chimp_rhesus_heart_specific_25_conserved_test <- read.table("../data/overlap_reg/human_chimp_rhesus_liver_specific_25_conserved_test.bed", header = FALSE)

#diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_25_hs_test, human_chimp_rhesus_heart_specific_25_conserved_test)

# liver specific 50%- human and chimp

human_chimp_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_liver_specific_50_hs_test.bed", header = FALSE)
human_chimp_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_liver_specific_50_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_50_hs_test, human_chimp_heart_specific_50_conserved_test)

# liver specific 50%- human, chimp, and rhesus

#human_chimp_rhesus_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_liver_specific_50_hs_test.bed", header = FALSE)
#human_chimp_rhesus_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_liver_specific_50_conserved_test.bed", header = FALSE)

#diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_50_hs_test, human_chimp_rhesus_heart_specific_50_conserved_test)



# liver specific 75%- human and chimp

human_chimp_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_liver_specific_75_hs_test.bed", header = FALSE)
human_chimp_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_liver_specific_75_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_75_hs_test, human_chimp_heart_specific_75_conserved_test)

# liver specific 75%- human, chimp, and rhesus

#human_chimp_rhesus_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_liver_specific_75_hs_test.bed", header = FALSE)
#human_chimp_rhesus_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_liver_specific_75_conserved_test.bed", header = FALSE)

#diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_75_hs_test, human_chimp_rhesus_heart_specific_75_conserved_test)


```



# lung specific

```{r}
# lung specific 25%- human and chimp

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_lung_specific_25_hs_test.bed", header = FALSE)

human_chimp_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_lung_specific_25_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_25_hs_test, human_chimp_heart_specific_25_conserved_test)

# lung specific 25%- human, chimp, and rhesus

#human_chimp_rhesus_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_lung_specific_25_hs_test.bed", header = FALSE)
#human_chimp_rhesus_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_lung_specific_25_conserved_test.bed", header = FALSE)

#diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_25_hs_test, human_chimp_rhesus_heart_specific_25_conserved_test)

# lung specific 50%- human and chimp

human_chimp_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_lung_specific_50_hs_test.bed", header = FALSE)
human_chimp_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_lung_specific_50_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_50_hs_test, human_chimp_heart_specific_50_conserved_test)

# lung specific 50%- human, chimp, and rhesus

#human_chimp_rhesus_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_lung_specific_50_hs_test.bed", header = FALSE)
#human_chimp_rhesus_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_lung_specific_50_conserved_test.bed", header = FALSE)

#diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_50_hs_test, human_chimp_rhesus_heart_specific_50_conserved_test)



# lung specific 75%- human and chimp

#human_chimp_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_lung_specific_75_hs_test.bed", header = FALSE)
#human_chimp_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_lung_specific_75_conserved_test.bed", header = FALSE)

#diff_prop_hs_versus_conserved(human_chimp_heart_specific_75_hs_test, human_chimp_heart_specific_75_conserved_test)

# lung specific 75%- human, chimp, and rhesus

#human_chimp_rhesus_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_lung_specific_75_hs_test.bed", header = FALSE)
#human_chimp_rhesus_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_lung_specific_75_conserved_test.bed", header = FALSE)

#diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_75_hs_test, human_chimp_rhesus_heart_specific_75_conserved_test)


```



# kidney specific (comparison with H3.K27ac.27)

```{r}
# kidney specific 25%- human and chimp

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_25_hs_test.bed", header = FALSE)

human_chimp_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_25_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_25_hs_test, human_chimp_heart_specific_25_conserved_test)

# kidney specific 25%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_25_hs_test.bed", header = FALSE)
human_chimp_rhesus_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_25_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_25_hs_test, human_chimp_rhesus_heart_specific_25_conserved_test)

# kidney specific 50%- human and chimp

human_chimp_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_50_hs_test.bed", header = FALSE)
human_chimp_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_50_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_50_hs_test, human_chimp_heart_specific_50_conserved_test)

# kidney specific 50%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_50_hs_test.bed", header = FALSE)
human_chimp_rhesus_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_50_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_50_hs_test, human_chimp_rhesus_heart_specific_50_conserved_test)



# kidney specific 75%- human and chimp

human_chimp_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_75_hs_test.bed", header = FALSE)
human_chimp_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_75_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_75_hs_test, human_chimp_heart_specific_75_conserved_test)

# kdiney specific 75%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_75_hs_test.bed", header = FALSE)
human_chimp_rhesus_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_75_conserved_test.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_75_hs_test, human_chimp_rhesus_heart_specific_75_conserved_test)


```


# kidney specific (comparison with H3.K27ac.153)

```{r}
# kidney specific 25%- human and chimp

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_25_hs_test2.bed", header = FALSE)

human_chimp_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_25_conserved_test2.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_25_hs_test, human_chimp_heart_specific_25_conserved_test)

# kidney specific 25%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_25_hs_test2.bed", header = FALSE)
human_chimp_rhesus_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_25_conserved_test2.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_25_hs_test, human_chimp_rhesus_heart_specific_25_conserved_test)

# kidney specific 50%- human and chimp

human_chimp_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_50_hs_test2.bed", header = FALSE)
human_chimp_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_50_conserved_test2.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_50_hs_test, human_chimp_heart_specific_50_conserved_test)

# kidney specific 50%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_50_hs_test2.bed", header = FALSE)
human_chimp_rhesus_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_50_conserved_test2.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_50_hs_test, human_chimp_rhesus_heart_specific_50_conserved_test)



# kidney specific 75%- human and chimp

human_chimp_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_75_hs_test2.bed", header = FALSE)
human_chimp_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_75_conserved_test2.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_75_hs_test, human_chimp_heart_specific_75_conserved_test)

# kdiney specific 75%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_75_hs_test2.bed", header = FALSE)
human_chimp_rhesus_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_75_conserved_test2.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_75_hs_test, human_chimp_rhesus_heart_specific_75_conserved_test)


```



# kidney specific (comparison with H3.K27ac.153)

```{r}
# kidney specific 25%- human and chimp

human_chimp_heart_specific_25_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_25_hs_test3.bed", header = FALSE)

human_chimp_heart_specific_25_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_25_conserved_test3.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_25_hs_test, human_chimp_heart_specific_25_conserved_test)


# kidney specific 50%- human and chimp

human_chimp_heart_specific_50_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_50_hs_test3.bed", header = FALSE)
human_chimp_heart_specific_50_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_50_conserved_test3.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_50_hs_test, human_chimp_heart_specific_50_conserved_test)


# kidney specific 75%- human and chimp

human_chimp_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_75_hs_test3.bed", header = FALSE)
human_chimp_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_kidney_specific_75_conserved_test3.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_heart_specific_75_hs_test, human_chimp_heart_specific_75_conserved_test)

# kdiney specific 75%- human, chimp, and rhesus

human_chimp_rhesus_heart_specific_75_hs_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_75_hs_test2.bed", header = FALSE)
human_chimp_rhesus_heart_specific_75_conserved_test <- read.delim("../data/overlap_reg/human_chimp_rhesus_kidney_specific_75_conserved_test2.bed", header = FALSE)

diff_prop_hs_versus_conserved(human_chimp_rhesus_heart_specific_75_hs_test, human_chimp_rhesus_heart_specific_75_conserved_test)


```



