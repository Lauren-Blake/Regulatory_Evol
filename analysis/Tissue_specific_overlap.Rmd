---
title: "Observed_versus_expected_tissue_specific"
author: "Lauren Blake"
date: "May 11, 2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

```{r}
RNA_seq_tissue_specific_overlap <- read.csv("../data/RNA_seq_tissue_specific_overlap.csv")

RNA_seq_tissue_specific_overlap[,11] <- RNA_seq_tissue_specific_overlap[,3]+RNA_seq_tissue_specific_overlap[,5]

library(ggplot2)
```



# Function for the human-chimpanzee tissue specific overlap

* m is the chimpanzee genes
* n is the Total genes - chimpanzee tissue-specific genes
* x/q is the overlap between human and chimpanzee tissue-specific genes
* k is the human tissue-specific genes

# Heart- human and chimp (conservative)

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 96,332, 117,425,134,551,72)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```


# liver- human and chimp

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 102,429, 199,495,153,479,77)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```


# lung- human and chimp

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 65,225, 90,380,144,557,39)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```


# kidney- human and chimp

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 33,224, 50,150,34,166,19)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```



# Human-chimpanzee-rhesus macaque tissue specific overlap

* m is the overlap of human+chimpanzee tissue-specific genes
* n is the Total genes - (overlap of human+chimpanzee tissue-specific genes)
* x/q is the overlap between human, chimpanzee, rhesus macaque tissue-specific genes
* k is the total rhesus tissue-specific genes

# Heart- 3 species (conservative)

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 96,332, 117,425,134,551,72)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# Liver- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 102,429, 199,495,153,479,77)


  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```


# lung- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 65,225, 90,380,144,557,39)


  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# kidney- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 33,224, 50,150,34,166,19)


  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# Heart- 3 species (lenient)

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 482,	219,	182,	514,	446,	514,	93)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# Liver- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 734,	234,	301,	565,	381,	644,	95)


  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```


# lung- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 408,	126,	125,	419,	419,	888,	63)


  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# kidney- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 172,	137,	86,	170,	170,	245,	31)


  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 12184 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

```{r}
library(VennDiagram)
library(RColorBrewer)
library(cowplot)
# Load colors 

colors <- colorRampPalette(c(brewer.pal(9, "Blues")[1],brewer.pal(9, "Blues")[9]))(100)
pal <- c(brewer.pal(9, "Set1"), brewer.pal(8, "Set2"), brewer.pal(12, "Set3"))


draw_venn_methylation <- function(hcr, hs, hc, cs, cr, rs, hr){
draw.triple.venn(hs+hc+hr+hcr, cs+hc+cr+hcr, rs+hr+cr+hcr, hc+hcr, cr+hcr, hr+hcr, hcr, filename = NULL, category = c("Hu", "Ch", "Rh"), fill = pal[1:3], main.cex = 3, cat.cex = 3, cex=3.5, lty=1, height=2000, width=2000, fontfamily = "sans", cat.fontfamily = "sans", main.fontfamily = "sans", cat.fontface = "bold", main.fontface = "bold", cat.dist = 0.05)
}

# Heart specific
svg("../data/Lenient_heart_specific.svg", width = 7.2, height = 7.2)
draw_venn_methylation(482,	219,	182,	514,	446,	514,	93)
dev.off()

svg("../data/Lenient_kidney_specific.svg", width = 7.2, height = 7.2)
draw_venn_methylation(172,	137,	86,	170,	92,	245,	31)
dev.off()

svg("../data/Lenient_liver_specific.svg", width = 7.2, height = 7.2)
draw_venn_methylation(734,	234,	301,	565,	381,	644,	95)
dev.off()

svg("../data/Lenient_lung_specific.svg", width = 7.2, height = 7.2)
draw_venn_methylation(408,	126,	125,	419,	412,	888, 63)
dev.off()

p1 <- ggdraw()+draw_image("../data/Lenient_heart_specific.svg") 
p2 <- ggdraw()+draw_image("../data/Lenient_kidney_specific.svg") 
p3 <- ggdraw()+draw_image("../data/Lenient_liver_specific.svg")  
p4 <- ggdraw()+draw_image("../data/Lenient_lung_specific.svg") 


eight_plots <- plot_grid(p1, p2, p3, p4, labels = c("2A. Heart", "2B. Kidney", "2C. Liver", "2D. Lung"), ncol = 2)
plot_fig2 <- plot_grid(eight_plots, ncol = 2, rel_heights=c(1, 1))

save_plot("../data/fig_2_lenient_ts.png", plot_fig2,
           ncol = 2, # we're saving a grid plot of 2 columns
           nrow = 2, # and 2 rows
           # each individual subplot should have an aspect ratio of 1.3
           base_aspect_ratio = 1
           )


```

# Methylation- humans and chimps

## Heart - 50% bp

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 36,	1816,	223,	915,	43,	1011,	58)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 1674083 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```

## Liver
```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 197,	1474,	575,	3708,	479,	8622,	251)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 1674083 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```

## Lung
```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 2,	240,	21,	263,	8,	311,	3)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 1674083 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```

## Kidney
```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 125,	2263,	420,	1089,	95,	2244,	209)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 1674083 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```

## Heart - 25% bp

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 66,	2413,	389,	1212,	76,	1354,	101)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 1674083 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```

## Liver
```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 478,	1556,	849,	4191,	843,	9717,	395)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 1674083 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```

## Lung
```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 5,	415,	46,	382,	20,	488,	13)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 1674083 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```

## Kidney
```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 287,	2763,	607,	1258,	148,	2812,	300)

 m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]+RNA_seq_tissue_specific_overlap[6]+RNA_seq_tissue_specific_overlap[7]
  n <- 1674083 - m
  x <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[4] + RNA_seq_tissue_specific_overlap[5] + RNA_seq_tissue_specific_overlap[9]

# Expected

 which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
 phyper(q, m, n, k, lower.tail = FALSE)

```

# Heart- 3 species, 50% bp

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 36,	1816,	223,	915,	43,	1011,	58)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 1493337 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```


# Liver- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 197,	1474,	575,	3708,	479,	8622,	251)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 1493337 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# Lung- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 2,	240,	21,	263,	8,	311,	3)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 1493337 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# Kidney- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 125,	2263,	420,	1089,	95,	2244,	209)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 1493337 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```


# Heart- 3 species, 25% bp

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 66,	2413,	389,	1212,	76,	1354,	101,	455)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 1493337 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```


# Liver- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 478,	1556,	849,	4191,	843,	9717,	395,	1327)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 1493337 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# Lung- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 5,	415,	46,	382,	20,	488,	13,	51)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 1493337 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```

# Kidney- 3 species

```{r}
RNA_seq_tissue_specific_overlap <- c(NA, NA, 287,	2763,	607,	1258,	148,	2812,	300,	894)

  m <- RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[5]
  n <- 1493337 - m
  x <- RNA_seq_tissue_specific_overlap[3] 
  q = x
  k = RNA_seq_tissue_specific_overlap[3] + RNA_seq_tissue_specific_overlap[7]+RNA_seq_tissue_specific_overlap[8]+RNA_seq_tissue_specific_overlap[9]

# Expected

which(grepl(max(dhyper(1:x, m, n, k)), dhyper(1:x, m, n, k)))

# P value of observed
phyper(q, m, n, k, lower.tail = FALSE)

```