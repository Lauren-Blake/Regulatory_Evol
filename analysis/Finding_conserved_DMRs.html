<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Lauren Blake" />


<title>Finding_conserved_DMRs</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">

/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}


/* offset scroll position for anchor links (for fixed navbar)  */
.section h2 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h3 {
  padding-top: 55px;
  margin-top: -55px;
}



/* don't use link color in navbar */
.dropdown-menu>li>a {
  color: black;
}

/* some padding for disqus */
#disqus_thread {
  margin-top: 45px;
}

</style>

<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RegulatoryEvolutionInPrimates</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="license.html">License</a></li>
        <li><a href="https://github.com/Lauren-Blake/Reg_Evo_Primates">GitHub</a></li>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Finding_conserved_DMRs</h1>
<h4 class="author"><em>Lauren Blake</em></h4>
<h4 class="date"><em>January 8, 2018</em></h4>

</div>

<div id="TOC">
<ul>
<li><a href="#how-much-do-tdmrs-overlap-between-species">How much do tDMRs overlap between species?</a></li>
</ul>
</div>

<p>How often is a tDMR in one species, a tDMR in another species?</p>
<pre class="r"><code># Import libraries

library(&quot;ggplot2&quot;)
library(&quot;VennDiagram&quot;)</code></pre>
<pre><code>Loading required package: grid</code></pre>
<pre><code>Loading required package: futile.logger</code></pre>
<pre class="r"><code>library(plyr)
library(&quot;bedr&quot;)</code></pre>
<pre><code>

######################
#### bedr v1.0.4 ####
######################

checking binary availability...
  * Checking path for bedtools... PASS
    /usr/local/bin/bedtools
  * Checking path for bedops... FAIL
  * Checking path for tabix... FAIL
tests and examples will be skipped on R CMD check if binaries are missing</code></pre>
<pre class="r"><code># Import the data

# Human tDMRs
humans_heart_kidney_DMRs &lt;- read.delim(&quot;../data/humans_heart_kidney_DMRs.txt&quot;)
humans_heart_liver_DMRs &lt;- read.delim(&quot;../data/humans_heart_liver_DMRs.txt&quot;)
humans_heart_lung_DMRs &lt;- read.delim(&quot;../data/humans_heart_lung_DMRs.txt&quot;)
humans_liver_lung_DMRs &lt;- read.delim(&quot;../data/humans_liver_lung_DMRs.txt&quot;)
humans_liver_kidney_DMRs &lt;- read.delim(&quot;../data/humans_liver_kidney_DMRs.txt&quot;)
humans_lung_kidney_DMRs &lt;- read.delim(&quot;../data/humans_lung_kidney_DMRs.txt&quot;)

levels(factor(humans_lung_kidney_DMRs[,1]))</code></pre>
<pre><code> [1] &quot;chr1&quot;  &quot;chr10&quot; &quot;chr11&quot; &quot;chr12&quot; &quot;chr13&quot; &quot;chr14&quot; &quot;chr15&quot; &quot;chr16&quot;
 [9] &quot;chr17&quot; &quot;chr18&quot; &quot;chr19&quot; &quot;chr2&quot;  &quot;chr20&quot; &quot;chr21&quot; &quot;chr22&quot; &quot;chr3&quot; 
[17] &quot;chr4&quot;  &quot;chr5&quot;  &quot;chr6&quot;  &quot;chr7&quot;  &quot;chr8&quot;  &quot;chr9&quot;  &quot;chrX&quot; </code></pre>
<pre class="r"><code>count(humans_lung_kidney_DMRs[,1])</code></pre>
<pre><code>       x freq
1   chr1 1486
2  chr10  974
3  chr11  777
4  chr12  836
5  chr13  446
6  chr14  516
7  chr15  549
8  chr16  785
9  chr17  852
10 chr18  484
11 chr19  647
12  chr2 1280
13 chr20  506
14 chr21  284
15 chr22  412
16  chr3  765
17  chr4  746
18  chr5  799
19  chr6  850
20  chr7  992
21  chr8  777
22  chr9  758
23  chrX  158</code></pre>
<pre class="r"><code># Chimp tDMRs
chimps_heart_kidney_DMRs &lt;- read.delim(&quot;../data/chimps_heart_kidney_DMRs.txt&quot;)
chimps_heart_liver_DMRs &lt;- read.delim(&quot;../data/chimps_heart_liver_DMRs.txt&quot;)
chimps_heart_lung_DMRs &lt;- read.delim(&quot;../data/chimps_heart_lung_DMRs.txt&quot;)
chimps_liver_lung_DMRs &lt;- read.delim(&quot;../data/chimps_liver_lung_DMRs.txt&quot;)
chimps_liver_kidney_DMRs &lt;- read.delim(&quot;../data/chimps_liver_kidney_DMRs.txt&quot;)
chimps_lung_kidney_DMRs &lt;- read.delim(&quot;../data/chimps_lung_kidney_DMRs.txt&quot;)

levels(factor(chimps_lung_kidney_DMRs[,1]))</code></pre>
<pre><code> [1] &quot;chr1&quot;                  &quot;chr10&quot;                
 [3] &quot;chr11&quot;                 &quot;chr11_gl000202_random&quot;
 [5] &quot;chr12&quot;                 &quot;chr13&quot;                
 [7] &quot;chr14&quot;                 &quot;chr15&quot;                
 [9] &quot;chr16&quot;                 &quot;chr17&quot;                
[11] &quot;chr18&quot;                 &quot;chr19&quot;                
[13] &quot;chr2&quot;                  &quot;chr20&quot;                
[15] &quot;chr21&quot;                 &quot;chr22&quot;                
[17] &quot;chr3&quot;                  &quot;chr4&quot;                 
[19] &quot;chr5&quot;                  &quot;chr6&quot;                 
[21] &quot;chr7&quot;                  &quot;chr8&quot;                 
[23] &quot;chr9&quot;                  &quot;chrX&quot;                 </code></pre>
<pre class="r"><code>count(chimps_lung_kidney_DMRs[,1])</code></pre>
<pre><code>                       x freq
1                   chr1 1021
2                  chr10  697
3                  chr11  592
4  chr11_gl000202_random    1
5                  chr12  621
6                  chr13  327
7                  chr14  408
8                  chr15  396
9                  chr16  528
10                 chr17  587
11                 chr18  348
12                 chr19  375
13                  chr2 1026
14                 chr20  353
15                 chr21  199
16                 chr22  272
17                  chr3  627
18                  chr4  662
19                  chr5  651
20                  chr6  692
21                  chr7  627
22                  chr8  542
23                  chr9  525
24                  chrX   16</code></pre>
<pre class="r"><code># Rhesus tDMRs

rhesus_heart_kidney_DMRs &lt;- read.delim(&quot;../data/rhesus_heart_kidney_DMRs.txt&quot;)
rhesus_heart_liver_DMRs &lt;- read.delim(&quot;../data/rhesus_heart_liver_DMRs.txt&quot;)
rhesus_heart_lung_DMRs &lt;- read.delim(&quot;../data/rhesus_heart_lung_DMRs.txt&quot;)
rhesus_liver_lung_DMRs &lt;- read.delim(&quot;../data/rhesus_liver_lung_DMRs.txt&quot;)
rhesus_liver_kidney_DMRs &lt;- read.delim(&quot;../data/rhesus_liver_kidney_DMRs.txt&quot;)
rhesus_lung_kidney_DMRs &lt;- read.delim(&quot;../data/rhesus_lung_kidney_DMRs.txt&quot;)

levels(factor(rhesus_heart_kidney_DMRs[,1]))</code></pre>
<pre><code> [1] &quot;chr1&quot;                  &quot;chr10&quot;                
 [3] &quot;chr11&quot;                 &quot;chr11_gl000202_random&quot;
 [5] &quot;chr12&quot;                 &quot;chr13&quot;                
 [7] &quot;chr14&quot;                 &quot;chr15&quot;                
 [9] &quot;chr16&quot;                 &quot;chr17&quot;                
[11] &quot;chr17_gl000204_random&quot; &quot;chr18&quot;                
[13] &quot;chr19&quot;                 &quot;chr2&quot;                 
[15] &quot;chr20&quot;                 &quot;chr21&quot;                
[17] &quot;chr22&quot;                 &quot;chr3&quot;                 
[19] &quot;chr4&quot;                  &quot;chr5&quot;                 
[21] &quot;chr6&quot;                  &quot;chr7&quot;                 
[23] &quot;chr8&quot;                  &quot;chr9&quot;                 
[25] &quot;chrX&quot;                 </code></pre>
<pre class="r"><code>count(rhesus_lung_kidney_DMRs[,1])</code></pre>
<pre><code>                       x freq
1                   chr1 1391
2                  chr10  929
3                  chr11  863
4                  chr12  799
5                  chr13  435
6                  chr14  519
7                  chr15  499
8                  chr16  821
9                  chr17  944
10 chr17_gl000204_random    1
11                 chr18  412
12                 chr19  655
13                  chr2 1180
14                 chr20  543
15                 chr21  252
16                 chr22  475
17                  chr3  709
18                  chr4  613
19                  chr5  713
20                  chr6  816
21                  chr7  853
22                  chr8  674
23                  chr9  794
24                  chrX   24</code></pre>
<div id="how-much-do-tdmrs-overlap-between-species" class="section level1">
<h1>How much do tDMRs overlap between species?</h1>
<pre class="r"><code># columns to pull
pull_col &lt;- c(1:3, 16)

# make bed style format
humans_heart_liver_DMRs_bed &lt;- humans_heart_liver_DMRs[,pull_col]

# Get DMRs on the autosomal chromosomes only
humans_heart_liver_DMRs_bed_noX &lt;- humans_heart_liver_DMRs_bed[which(humans_heart_liver_DMRs_bed[,1] != &quot;chrX&quot;),]

humans_heart_liver_DMRs_bed_noX[,1] &lt;- as.character(humans_heart_liver_DMRs_bed_noX[,1])
humans_heart_liver_DMRs_bed_noX[,2] &lt;- as.integer(humans_heart_liver_DMRs_bed_noX[,2])
humans_heart_liver_DMRs_bed_noX[,3] &lt;- as.integer(humans_heart_liver_DMRs_bed_noX[,3])

summary(humans_heart_liver_DMRs_bed_noX[,3] - humans_heart_liver_DMRs_bed_noX[,2])</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    5.0   255.0   473.0   584.5   795.0  4797.0 </code></pre>
<pre class="r"><code>sort_humans_heart_liver_DMRs_bed &lt;- bedr.sort.region(humans_heart_liver_DMRs_bed_noX)</code></pre>
<pre><code>SORTING
VALIDATE REGIONS
 * Checking input type... PASS
   Input is in bed format
 * Check if index is a string... PASS
 * Check index pattern... PASS
 * Check for missing values... PASS
 * Check for larger start position... PASS.
 * Check if zero based... PASS
 * Overlapping regions can cause unexpected results.</code></pre>
<pre class="r"><code># make bed style format
humans_heart_lung_DMRs_bed &lt;- chimps_heart_liver_DMRs[,pull_col]
humans_heart_lung_DMRs_bed_noX &lt;- humans_heart_lung_DMRs_bed[which(humans_heart_lung_DMRs_bed[,1] != &quot;chrX&quot;),]

humans_heart_lung_DMRs_bed_noX[,1] &lt;- as.character(humans_heart_lung_DMRs_bed_noX[,1])
humans_heart_lung_DMRs_bed_noX[,2] &lt;- as.integer(humans_heart_lung_DMRs_bed_noX[,2])
humans_heart_lung_DMRs_bed_noX[,3] &lt;- as.integer(humans_heart_lung_DMRs_bed_noX[,3])
sort_humans_heart_lung_DMRs_bed &lt;- bedr.sort.region(humans_heart_lung_DMRs_bed_noX, check.chr=FALSE)</code></pre>
<pre><code>SORTING
VALIDATE REGIONS
 * Checking input type... PASS
   Input is in bed format
 * Check if index is a string... PASS
 * Check index pattern... PASS
 * Check for missing values... PASS
 * Check for larger start position... PASS.
 * Check if zero based... PASS
 * Overlapping regions can cause unexpected results.</code></pre>
<pre class="r"><code>summary(humans_heart_lung_DMRs_bed_noX[,3] - humans_heart_lung_DMRs_bed_noX[,2])</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    5.0   266.0   498.0   617.6   849.0  4950.0 </code></pre>
<pre class="r"><code>heart_lung &lt;- bedr(input = list(a = sort_humans_heart_liver_DMRs_bed, b = sort_humans_heart_lung_DMRs_bed), method = &quot;intersect&quot;,  params = &quot;-wao -f 0.5 -F 0.5&quot;, check.chr = FALSE)</code></pre>
<pre><code> * Processing input (1): a
CONVERT TO BED
 * Checking input type... PASS
   Input is in bed format
VALIDATE REGIONS
 * Check if index is a string... PASS
 * Check index pattern... PASS
 * Check for missing values... PASS
 * Check for larger start position... PASS.
 * Check if zero based... PASS
 * Checking sort order... PASS
 * Checking for overlapping &#39;contiguous&#39; regions... PASS
 * Processing input (2): b
CONVERT TO BED
 * Checking input type... PASS
   Input is in bed format
VALIDATE REGIONS
 * Check if index is a string... PASS
 * Check index pattern... PASS
 * Check for missing values... PASS
 * Check for larger start position... PASS.
 * Check if zero based... PASS
 * Checking sort order... PASS
 * Checking for overlapping &#39;contiguous&#39; regions... PASS
   bedtools intersect -a /var/folders/rf/qrcw6ncj05z1pc_pq9xzw3540000gn/T//Rtmp6mLwti/a_3ee42c345a50.bed -b /var/folders/rf/qrcw6ncj05z1pc_pq9xzw3540000gn/T//Rtmp6mLwti/b_3ee455a50016.bed -wao -f 0.5 -F 0.5</code></pre>
<pre class="r"><code>summary(heart_lung[,3] - heart_lung[,2])</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    5.0   255.0   473.0   584.5   795.0  4797.0 </code></pre>
<pre class="r"><code>summary(as.integer(heart_lung[,9]))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
      0       0       0     202     274    4413 </code></pre>
<pre class="r"><code>summary(as.integer(heart_lung[,9]) &gt; 0)</code></pre>
<pre><code>   Mode   FALSE    TRUE 
logical   15931    6630 </code></pre>
<pre class="r"><code>lung_heart &lt;- bedr(input = list(a = sort_humans_heart_lung_DMRs_bed, b = sort_humans_heart_liver_DMRs_bed), method = &quot;intersect&quot;,  params = &quot;-wao -f 0.5 -F 0.5&quot;, check.chr = FALSE)</code></pre>
<pre><code> * Processing input (1): a
CONVERT TO BED
 * Checking input type... PASS
   Input is in bed format
VALIDATE REGIONS
 * Check if index is a string... PASS
 * Check index pattern... PASS
 * Check for missing values... PASS
 * Check for larger start position... PASS.
 * Check if zero based... PASS
 * Checking sort order... PASS
 * Checking for overlapping &#39;contiguous&#39; regions... PASS
 * Processing input (2): b
CONVERT TO BED
 * Checking input type... PASS
   Input is in bed format
VALIDATE REGIONS
 * Check if index is a string... PASS
 * Check index pattern... PASS
 * Check for missing values... PASS
 * Check for larger start position... PASS.
 * Check if zero based... PASS
 * Checking sort order... PASS
 * Checking for overlapping &#39;contiguous&#39; regions... PASS
   bedtools intersect -a /var/folders/rf/qrcw6ncj05z1pc_pq9xzw3540000gn/T//Rtmp6mLwti/a_3ee455c8044.bed -b /var/folders/rf/qrcw6ncj05z1pc_pq9xzw3540000gn/T//Rtmp6mLwti/b_3ee4663f7b53.bed -wao -f 0.5 -F 0.5</code></pre>
<pre class="r"><code>summary(as.integer(lung_heart[,9]))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    0.0     0.0     0.0   158.4     0.0  4413.0 </code></pre>
<pre class="r"><code>summary(as.integer(lung_heart[,9]) &gt; 0)</code></pre>
<pre><code>   Mode   FALSE    TRUE 
logical   22139    6630 </code></pre>
<pre class="r"><code># Make a Venn diagram based on the results

summary(as.integer(heart_lung[,9]) &gt; 0)</code></pre>
<pre><code>   Mode   FALSE    TRUE 
logical   15931    6630 </code></pre>
<pre class="r"><code>summary(as.integer(lung_heart[,9]) &gt; 0)</code></pre>
<pre><code>   Mode   FALSE    TRUE 
logical   22139    6630 </code></pre>
<pre class="r"><code>grid.newpage()
draw.pairwise.venn(area1 = 22561, area2 = 14208, cross.area = 3858, category = c(&quot;Heart v. Liver&quot;, &quot;Heart v. Lung&quot;))</code></pre>
<p><img src="figure/Finding_conserved_DMRs.Rmd/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>(polygon[GRID.polygon.1], polygon[GRID.polygon.2], polygon[GRID.polygon.3], polygon[GRID.polygon.4], text[GRID.text.5], text[GRID.text.6], text[GRID.text.7], text[GRID.text.8], text[GRID.text.9]) </code></pre>
<pre class="r"><code># Find out how many are in the same direction

heart_lung_subset &lt;- heart_lung[which(heart_lung[,9] &gt; 0) , ]
summary(heart_lung_subset[,4] == heart_lung_subset[,8])</code></pre>
<pre><code>   Mode   FALSE    TRUE 
logical       4    6626 </code></pre>
</div>


<!-- some extra javascript for older browsers -->
<script type="text/javascript" src="libs/polyfill.js"></script>

<script>

// manage active state of menu based on current page
$(document).ready(function () {

    // active menu
    href = window.location.pathname
    href = href.substr(href.lastIndexOf('/') + 1)
    $('a[href="' + href + '"]').parent().addClass('active');

    // manage active menu header
    if (href.startsWith('authoring_'))
      $('a[href="' + 'authoring' + '"]').parent().addClass('active');
    else if (href.endsWith('_format.html'))
      $('a[href="' + 'formats' + '"]').parent().addClass('active');
    else if (href.startsWith('developer_'))
      $('a[href="' + 'developer' + '"]').parent().addClass('active');

});

</script>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
